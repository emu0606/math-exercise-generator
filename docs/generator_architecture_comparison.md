# ç”Ÿæˆå™¨æ¶æ§‹å°æ¯”å¿ƒå¾— - å·¥ç¨‹å¯¦ç”¨æ€§åˆ†æ

> **ä½œè€…**: ç³»çµ±æ¶æ§‹åˆ†æ  
> **æ—¥æœŸ**: 2025-09-11  
> **å°æ¯”å°è±¡**: DoubleRadicalSimplificationGenerator èˆŠç‰ˆ vs æ–°ç‰ˆ  
> **ç›®æ¨™**: ç‚ºé–‹ç™¼åœ˜éšŠæä¾›æ¶æ§‹é¸æ“‡æŒ‡å°

## ğŸ“‹ **å°æ¯”æ¦‚è¿°**

é€šéå° `DoubleRadicalSimplificationGenerator` æ–°èˆŠç‰ˆæœ¬çš„æ·±åº¦å°æ¯”åˆ†æï¼Œæˆ‘å€‘ç™¼ç¾äº†ç¾ä»£åŒ–é‡æ§‹ä¸­çš„å¾—å¤±ã€‚æ–°ç‰ˆæœ¬åœ¨å·¥ç¨‹æ¨™æº–ä¸Šæœ‰é¡¯è‘—æå‡ï¼Œä½†ä¹Ÿå¼•å…¥äº†ä¸€äº›éåº¦å·¥ç¨‹åŒ–çš„å•é¡Œã€‚

### **æ•¸æ“šå°æ¯”**
- **èˆŠç‰ˆ**: 150è¡Œï¼Œå–®ä¸€æ–¹æ³•ï¼Œç›´æ¥é‚è¼¯
- **æ–°ç‰ˆ**: 450è¡Œï¼ŒPydanticé©—è­‰ï¼Œæ¨¡çµ„åŒ–è¨­è¨ˆ
- **åŠŸèƒ½**: å…©ç‰ˆæœ¬å¯¦ç¾å®Œå…¨ç›¸åŒçš„æ•¸å­¸åŠŸèƒ½

---

## ğŸ¯ **æ¶æ§‹å„ªå‹¢åˆ†æ**

### **æ–°ç‰ˆæ¶æ§‹çš„çœŸå¯¦åƒ¹å€¼**

#### **âœ… ç•°å¸¸è™•ç† - çœŸæ­£çš„æ”¹é€²**
```python
# æ–°ç‰ˆï¼šå®Œæ•´çš„éŒ¯èª¤è™•ç†
def generate_question(self) -> Dict[str, Any]:
    for attempt in range(self.params.max_attempts):
        try:
            result = self._generate_single_question()
            if result:
                logger.info(f"æˆåŠŸç”Ÿæˆé¡Œç›®ï¼ˆç¬¬ {attempt + 1} æ¬¡å˜—è©¦ï¼‰")
                return result
        except Exception as e:
            logger.warning(f"ç”Ÿæˆå˜—è©¦ {attempt + 1} å¤±æ•—: {str(e)}")
            continue

# èˆŠç‰ˆï¼šæ²’æœ‰ç•°å¸¸è™•ç†
for _ in range(max_attempts):
    # sympy é‹ç®—å¯èƒ½æ‹‹å‡ºç•°å¸¸ï¼Œä½†æ²’æœ‰æ•ç²
    squared = expand(expr**2)  # å¯èƒ½å¤±æ•—
```

**åƒ¹å€¼è©•ä¼°**: â­â­â­â­â­ **éå¸¸å¯¦ç”¨**
- **è§£æ±ºçœŸå¯¦å•é¡Œ**: sympy åœ¨æŸäº›æƒ…æ³ä¸‹ç¢ºå¯¦æœƒæ‹‹å‡ºç•°å¸¸
- **æå‡ç”¨æˆ¶é«”é©—**: é¿å…ç¨‹å¼å´©æ½°ï¼Œæä¾›æœ‰æ„ç¾©çš„éŒ¯èª¤ä¿¡æ¯
- **ä¾¿æ–¼èª¿è©¦**: æ—¥èªŒè¨˜éŒ„å¹«åŠ©å®šä½å•é¡Œ

#### **âœ… æ¨¡çµ„åŒ–è¨­è¨ˆ - å¯¦è³ªæ”¹é€²**
```python
# æ–°ç‰ˆï¼šåŠŸèƒ½åˆ†é›¢
def generate_question(self) -> Dict[str, Any]:
    # ä¸»æ§é‚è¼¯ï¼Œç°¡æ½”æ˜ç­
    
def _generate_single_question(self) -> Optional[Dict[str, Any]]:
    # å–®æ¬¡ç”Ÿæˆé‚è¼¯
    
def _is_trivial_case(self, a: int, b: int) -> bool:
    # æ•¸å­¸é‚è¼¯åˆ¤æ–·
    
def _assess_difficulty(self, a: int, b: int, is_addition: bool) -> str:
    # é›£åº¦è©•ä¼°

# èˆŠç‰ˆï¼šæ‰€æœ‰é‚è¼¯æ“ åœ¨ä¸€å€‹æ–¹æ³•ä¸­
def generate_question(self) -> Dict[str, Any]:
    # 150è¡Œçš„å·¨å¤§æ–¹æ³•ï¼ŒåŒ…å«æ‰€æœ‰é‚è¼¯
```

**åƒ¹å€¼è©•ä¼°**: â­â­â­â­ **å¾ˆå¯¦ç”¨**
- **æå‡å¯è®€æ€§**: æ¯å€‹æ–¹æ³•è·è²¬æ˜ç¢º
- **ä¾¿æ–¼æ¸¬è©¦**: å¯ä»¥å–®ç¨æ¸¬è©¦æ¯å€‹æ•¸å­¸é‚è¼¯
- **æ˜“æ–¼ä¿®æ”¹**: ä¿®æ”¹é›£åº¦è©•ä¼°ä¸å½±éŸ¿å…¶ä»–é‚è¼¯

#### **âœ… æ—¥èªŒç³»çµ± - æ˜é¡¯æ”¹é€²**
```python
# æ–°ç‰ˆï¼šçµ±ä¸€æ—¥èªŒ
logger = get_logger(__name__)
logger.info("é–‹å§‹ç”Ÿæˆé›™é‡æ ¹å¼åŒ–ç°¡é¡Œç›®")
logger.warning(f"ç”Ÿæˆå˜—è©¦ {attempt + 1} å¤±æ•—: {str(e)}")

# èˆŠç‰ˆï¼šæ²’æœ‰æ—¥èªŒ
# èª¿è©¦æ™‚åªèƒ½ç”¨ print() æˆ–è¨­æ–·é»
```

**åƒ¹å€¼è©•ä¼°**: â­â­â­â­ **å¾ˆå¯¦ç”¨**
- **ä¾¿æ–¼èª¿è©¦**: å¯ä»¥è¿½è¹¤ç”Ÿæˆéç¨‹å’Œå¤±æ•—åŸå› 
- **ç”Ÿç”¢ç›£æ§**: å¯ä»¥ç›£æ§ç³»çµ±é‹è¡Œç‹€æ³
- **çµ±ä¸€æ¨™æº–**: æ•´å€‹ç³»çµ±ä½¿ç”¨çµ±ä¸€çš„æ—¥èªŒæ ¼å¼

---

## âš ï¸ **éåº¦å·¥ç¨‹åŒ–å•é¡Œ**

### **âŒ Pydantic åƒæ•¸é©—è­‰ - è§£æ±ºä¸å­˜åœ¨çš„å•é¡Œ**

#### **ç†è«–åƒ¹å€¼ vs å¯¦éš›éœ€æ±‚**
```python
# æ–°ç‰ˆï¼š50è¡Œåƒæ•¸é©—è­‰
class DoubleRadicalParams(BaseModel):
    max_value: int = Field(
        default=25, 
        ge=5, le=100,  # é˜²æ­¢ä»€éº¼ï¼Ÿèª°æœƒè¼¸å…¥-5ï¼Ÿ
        description="æ ¹å¼å…§æ•¸å€¼çš„æœ€å¤§ç¯„åœ"
    )
    max_attempts: int = Field(
        default=100, 
        ge=10, le=1000,  # é˜²æ­¢ä»€éº¼ï¼Ÿèª°æœƒè¨­ç½®9æ¬¡å˜—è©¦ï¼Ÿ
        description="ç”Ÿæˆæœ‰æ•ˆé¡Œç›®çš„æœ€å¤§å˜—è©¦æ¬¡æ•¸"
    )
    # ... æ›´å¤šé©—è­‰é‚è¼¯

# èˆŠç‰ˆï¼š1è¡Œæå®š
max_value = self.options.get('max_value', 25)
```

#### **å¯¦éš›ä½¿ç”¨å ´æ™¯åˆ†æ**
1. **æ¡Œé¢æ‡‰ç”¨ç’°å¢ƒ**ï¼š
   - è€å¸«é€šéUIæ“ä½œï¼ŒUIå±¤é¢å·²é™åˆ¶è¼¸å…¥ç¯„åœ
   - ä¸æ˜¯é«˜ä¸¦ç™¼Web APIï¼Œç„¡éœ€é˜²ç¯„æƒ¡æ„è¼¸å…¥

2. **é–‹ç™¼ç’°å¢ƒ**ï¼š
   - ç¨‹å¼äººå“¡çŸ¥é“åˆç†åƒæ•¸ç¯„åœ
   - å¯§å¯è®“éŒ¯èª¤åƒæ•¸å¿«é€Ÿå¤±æ•—ï¼Œä¾¿æ–¼èª¿è©¦

3. **åƒæ•¸è¤‡é›œåº¦**ï¼š
   - åªæœ‰max_valueã€difficultyç­‰ç°¡å–®åƒæ•¸
   - ä¸æ˜¯è¤‡é›œçš„é…ç½®ç³»çµ±

**å•é¡Œè©•ä¼°**: âŒ **éåº¦å·¥ç¨‹åŒ–**
- **æˆæœ¬**: 50è¡Œä»£ç¢¼ + å­¸ç¿’Pydanticèªæ³•
- **æ”¶ç›Š**: é˜²ç¯„å¹¾ä¹ä¸å¯èƒ½ç™¼ç”Ÿçš„åƒæ•¸éŒ¯èª¤
- **çµè«–**: æˆæœ¬ > æ”¶ç›Š

#### **å‹™å¯¦çš„æ›¿ä»£æ–¹æ¡ˆ**
```python
def __init__(self, options=None):
    self.options = options or {}
    
    # ç°¡å–®æœ‰æ•ˆçš„åƒæ•¸è™•ç†
    self.max_value = self.options.get('max_value', 25)
    self.max_attempts = self.options.get('max_attempts', 100)
    
    # åªåœ¨çœŸæ­£ä¸åˆç†æ™‚è­¦å‘Šï¼ˆå¯é¸ï¼‰
    if self.max_value < 1:
        logger.warning(f"max_value={self.max_value} ä¼¼ä¹ä¸åˆç†ï¼Œä½¿ç”¨é è¨­å€¼25")
        self.max_value = 25
```

**å„ªå‹¢**ï¼š
- ä»£ç¢¼ç°¡æ½”æ˜ç­
- ç„¡éœ€é¡å¤–ä¾è³´
- ä¿æŒéˆæ´»æ€§
- å•é¡Œæ™‚æœ‰è­¦å‘Šä½†ä¸é˜»æ–·

---

## ğŸ“Š **æˆæœ¬æ•ˆç›Šåˆ†æ**

### **æ–°ç‰ˆæ¶æ§‹æˆæœ¬**
| é …ç›® | èˆŠç‰ˆ | æ–°ç‰ˆ | å¢åŠ æˆæœ¬ |
|------|------|------|----------|
| **ä»£ç¢¼è¡Œæ•¸** | 150è¡Œ | 450è¡Œ | +200% |
| **ä¾è³´é …** | sympy, numpy | +pydantic | +å­¸ç¿’æˆæœ¬ |
| **è¤‡é›œåº¦** | ä½ | ä¸­é«˜ | +ç¶­è­·æˆæœ¬ |
| **ä¿®æ”¹é›£åº¦** | ç°¡å–® | éœ€ç†è§£æ¶æ§‹ | +é–‹ç™¼æˆæœ¬ |

### **æ–°ç‰ˆæ¶æ§‹æ”¶ç›Š**
| é …ç›® | å¯¦éš›åƒ¹å€¼ | è©•åˆ† |
|------|----------|------|
| **ç•°å¸¸è™•ç†** | é˜²æ­¢å´©æ½°ï¼Œæå‡ç©©å®šæ€§ | â­â­â­â­â­ |
| **æ¨¡çµ„åŒ–** | æå‡å¯è®€æ€§å’Œå¯æ¸¬è©¦æ€§ | â­â­â­â­ |
| **æ—¥èªŒç³»çµ±** | ä¾¿æ–¼èª¿è©¦å’Œç›£æ§ | â­â­â­â­ |
| **åƒæ•¸é©—è­‰** | é˜²ç¯„ä¸å¤ªå¯èƒ½çš„éŒ¯èª¤ | â­ |

### **æŠ•è³‡å›å ±ç‡**
- **é«˜åƒ¹å€¼æ”¹é€²**ï¼šç•°å¸¸è™•ç†ã€æ¨¡çµ„åŒ–ã€æ—¥èªŒ (75%çš„æ–°å¢åƒ¹å€¼)
- **ä½åƒ¹å€¼æ”¹é€²**ï¼šPydanticé©—è­‰ (25%çš„æ–°å¢åƒ¹å€¼ï¼Œä½†ä½”ç”¨40%çš„ä»£ç¢¼)

---

## ğŸ¯ **å¯¦ç”¨å»ºè­°**

### **æ¨è–¦çš„ç†æƒ³æ¶æ§‹**

```python
class IdealGenerator(QuestionGenerator):
    """èåˆå¯¦ç”¨æ€§çš„ç†æƒ³ç¯„æœ¬"""
    
    def __init__(self, options=None):
        super().__init__(options)
        self.options = options or {}
        
        # èˆŠç‰ˆçš„ç°¡æ½”æ€§ + åŸºæœ¬åˆç†æ€§æª¢æŸ¥
        self.max_value = max(5, min(100, self.options.get('max_value', 25)))
        self.max_attempts = max(10, min(1000, self.options.get('max_attempts', 100)))
        
        # æ–°ç‰ˆçš„æ—¥èªŒç³»çµ±
        self.logger = get_logger(self.__class__.__name__)
        
    def generate_question(self) -> Dict[str, Any]:
        """æ–°ç‰ˆçš„ç•°å¸¸è™•ç† + èˆŠç‰ˆçš„ç›´æ¥é‚è¼¯"""
        self.logger.info("é–‹å§‹ç”Ÿæˆé¡Œç›®")
        
        for attempt in range(self.max_attempts):
            try:
                result = self._generate_core_logic()
                if result:
                    self.logger.info(f"ç”ŸæˆæˆåŠŸï¼ˆç¬¬ {attempt + 1} æ¬¡å˜—è©¦ï¼‰")
                    return result
            except Exception as e:
                self.logger.warning(f"ç”Ÿæˆå¤±æ•—: {str(e)}")
                continue
                
        return self._get_fallback_question()
    
    def _generate_core_logic(self):
        """èˆŠç‰ˆçš„ç›´æ¥é‚è¼¯é¢¨æ ¼"""
        # æ ¸å¿ƒæ•¸å­¸é‚è¼¯ï¼Œä¿æŒç°¡æ½”ç›´æ¥
        # ...
        
    def _is_valid_case(self, a, b):
        """æ–°ç‰ˆçš„æ¨¡çµ„åŒ–é¢¨æ ¼"""
        # æ•¸å­¸é‚è¼¯æª¢æŸ¥
        # ...
```

### **é¸æ“‡åŸå‰‡**

#### **æ¡ç”¨æ–°ç‰ˆé¢¨æ ¼çš„æƒ…æ³**ï¼š
- âœ… **ç•°å¸¸è™•ç†**: æ‰€æœ‰ç”Ÿæˆå™¨éƒ½æ‡‰è©²æœ‰
- âœ… **æ—¥èªŒç³»çµ±**: ä¾¿æ–¼èª¿è©¦å’Œç›£æ§
- âœ… **æ¨¡çµ„åŒ–**: è¤‡é›œé‚è¼¯æ™‚æ¡ç”¨

#### **é¿å…çš„éåº¦å·¥ç¨‹åŒ–**ï¼š
- âŒ **Pydanticé©—è­‰**: å°æ–¼ç°¡å–®åƒæ•¸æ˜¯overkill
- âŒ **éåº¦æŠ½è±¡**: ä¸è¦ç‚ºäº†æ¶æ§‹è€ŒçŠ§ç‰²å¯è®€æ€§
- âŒ **è¤‡é›œé…ç½®**: ä¿æŒåƒæ•¸è™•ç†çš„ç°¡æ½”æ€§

### **ä¸åŒé¡Œå‹çš„å»ºè­°**

#### **ç°¡å–®é¡Œå‹ï¼ˆä¸‰è§’å‡½æ•¸å€¼è¨ˆç®—ï¼‰**ï¼š
```python
# æ¡ç”¨èˆŠç‰ˆ + åŸºæœ¬ç•°å¸¸è™•ç†
def generate_question(self):
    try:
        # ç›´æ¥çš„ç”Ÿæˆé‚è¼¯
        return question_data
    except Exception as e:
        logger.error(f"ç”Ÿæˆå¤±æ•—: {e}")
        return fallback_question
```

#### **è¤‡é›œé¡Œå‹ï¼ˆä»£æ•¸åŒ–ç°¡ã€å¹¾ä½•è­‰æ˜ï¼‰**ï¼š
```python
# æ¡ç”¨æ–°ç‰ˆç°¡åŒ–æ¨¡å¼
def generate_question(self):
    for attempt in range(self.max_attempts):
        try:
            result = self._generate_single_question()
            if self._validate_result(result):
                return result
        except Exception as e:
            logger.warning(f"å˜—è©¦ {attempt} å¤±æ•—: {e}")
    return self._get_fallback_question()
```

---

## ğŸ“ **çµè«–èˆ‡å»ºè­°**

### **æ ¸å¿ƒç™¼ç¾**
1. **æ–°ç‰ˆçš„ç•°å¸¸è™•ç†ã€æ¨¡çµ„åŒ–ã€æ—¥èªŒç³»çµ±æ˜¯çœŸæ­£çš„æ”¹é€²**ï¼Œæ‡‰è©²ä¿ç•™
2. **Pydanticåƒæ•¸é©—è­‰åœ¨é€™å€‹contextä¸­æ˜¯éåº¦å·¥ç¨‹åŒ–**ï¼Œæˆæœ¬å¤§æ–¼æ”¶ç›Š
3. **æœ€ä½³å¯¦è¸æ˜¯èåˆå…©ç‰ˆå„ªé»**ï¼šæ–°ç‰ˆçš„å¥å£¯æ€§ + èˆŠç‰ˆçš„ç°¡æ½”æ€§

### **å°é–‹ç™¼åœ˜éšŠçš„å»ºè­°**
1. **ä¿ç•™æœ‰åƒ¹å€¼çš„æ”¹é€²**ï¼šç•°å¸¸è™•ç†ã€æ—¥èªŒã€æ¨¡çµ„åŒ–
2. **ç°¡åŒ–éåº¦å·¥ç¨‹çš„éƒ¨åˆ†**ï¼šåƒæ•¸é©—è­‰æ”¹ç‚ºç°¡å–®æª¢æŸ¥
3. **æ ¹æ“šè¤‡é›œåº¦é¸æ“‡é¢¨æ ¼**ï¼šç°¡å–®é¡Œå‹ç”¨èˆŠç‰ˆé¢¨æ ¼ï¼Œè¤‡é›œé¡Œå‹ç”¨æ–°ç‰ˆç°¡åŒ–é¢¨æ ¼

### **å°æ¶æ§‹æ¼”é€²çš„æ€è€ƒ**
ä¸æ˜¯æ‰€æœ‰çš„"æœ€ä½³å¯¦è¸"éƒ½é©ç”¨æ–¼æ¯å€‹å°ˆæ¡ˆcontextã€‚åœ¨æ•¸å­¸é¡Œç›®ç”Ÿæˆå™¨é€™å€‹é ˜åŸŸï¼š
- **ç©©å®šæ€§** > **æ¶æ§‹å®Œç¾æ€§**
- **å¯è®€æ€§** > **æŠ€è¡“å…ˆé€²æ€§**  
- **å¯¦ç”¨æ€§** > **æ¨™æº–ç¬¦åˆåº¦**

**å¥½çš„æ¶æ§‹æ‡‰è©²æ˜¯è§£æ±ºå¯¦éš›å•é¡Œï¼Œè€Œä¸æ˜¯ç‚«è€€æŠ€è¡“èƒ½åŠ›ã€‚**

---

## ğŸ“‹ **TrigonometricFunctionGenerator å°æ¯”åˆ†æè£œå……**

### **ç¯„æœ¬è¨­è¨ˆçš„é—œéµç™¼ç¾**

é€šéå°ä¸‰è§’å‡½æ•¸ç”Ÿæˆå™¨çš„æ·±åº¦å°æ¯”ï¼Œæˆ‘å€‘ç™¼ç¾äº†æ›´å¤šç¯„æœ¬è¨­è¨ˆçš„é‡è¦åŸå‰‡ï¼š

#### **ğŸ¯ ç³»çµ±å…¼å®¹æ€§æ˜¯ä¸å¯å¦¥å”çš„åŸºç¤**

**èˆŠç‰ˆçš„æˆåŠŸè¨­è¨ˆ**ï¼š
```python
return {
    "question": question_text,
    "answer": answer,
    "explanation": explanation,
    "figure_data_question": figure_data_question,      # PDFç³»çµ±å¿…éœ€
    "figure_data_explanation": figure_data_explanation, # PDFç³»çµ±å¿…éœ€
    "figure_position": "right",
    "explanation_figure_position": "right"
}
```

**æ–°ç‰ˆçš„å¤±æ•—è¨­è¨ˆ**ï¼š
```python
return {
    "question": question,
    "answer": answer,
    "explanation": explanation
    # âŒ å®Œå…¨ç§»é™¤åœ–å½¢æ”¯æ´ï¼Œå°è‡´PDFç”Ÿæˆå¤±æ•—
}
```

**ç¯„æœ¬åŸå‰‡**: ç”Ÿæˆå™¨å¿…é ˆèˆ‡ç¾æœ‰ç³»çµ±å®Œå…¨å…¼å®¹ï¼Œé€™æ¯”æ¶æ§‹ç´”æ½”æ€§æ›´é‡è¦ã€‚

#### **ğŸ”§ æ•¸å­¸é¡Œå‹ç‰¹åŒ–çš„åƒ¹å€¼**

**èˆŠç‰ˆçš„ç‰¹åŒ–å„ªå‹¢**ï¼š
```python
def __init__(self, options):
    # é‡å°ä¸‰è§’å‡½æ•¸çš„ç‰¹åŒ–è¨­è¨ˆ
    self.trig_values = self._build_trig_value_table()  # é å»ºæŸ¥è©¢è¡¨
    self.definitions = {                                # æ•¸å­¸å®šç¾©
        "sin": "\\frac{y}{r}",
        "cos": "\\frac{x}{r}",
        "tan": "\\frac{y}{x}"
    }
```

**æ–°ç‰ˆçš„æ³›åŒ–å•é¡Œ**ï¼š
```python
class TrigonometricParams(BaseModel):
    # å¤§é‡é€šç”¨é©—è­‰é‚è¼¯ï¼Œä½†å¤±å»ä¸‰è§’å‡½æ•¸çš„ç¨ç‰¹ç‰¹æ€§
    functions: List[TrigFunction] = Field(...)
    angles: List[int] = Field(...)
```

**ç¯„æœ¬åŸå‰‡**: æ”¯æ´é¡Œå‹ç‰¹åŒ–è¨­è¨ˆï¼Œä¸è¦ç‚ºäº†çµ±ä¸€è€ŒçŠ§ç‰²å°ˆæ¥­æ€§ã€‚

#### **âš¡ é è¨ˆç®—å„ªåŒ–çš„é‡è¦æ€§**

**èˆŠç‰ˆçš„æ™ºæ…§è¨­è¨ˆ**ï¼š
```python
# åˆå§‹åŒ–æ™‚é å»ºæŸ¥è©¢è¡¨ï¼Œé¿å…é‡è¤‡è¨ˆç®—
def _build_trig_value_table(self):
    """é å…ˆè¨ˆç®—æ‰€æœ‰ä¸‰è§’å‡½æ•¸å€¼"""
    # ä¸€æ¬¡æ€§è¨ˆç®—ï¼Œå¾ŒçºŒç›´æ¥æŸ¥è¡¨
```

**æ–°ç‰ˆçš„é‡è¤‡è¨ˆç®—**ï¼š
```python
# æ¯æ¬¡éƒ½é‡æ–°è¨ˆç®—sympyè¡¨é”å¼
def _generate_single_question(self, func_enum, angle):
    angle_rad = angle * pi / 180
    value = simplify(func_sympy(angle_rad))  # é‡è¤‡è¨ˆç®—
```

**ç¯„æœ¬åŸå‰‡**: å°æ–¼å›ºå®šæ•¸æ“šé›†ï¼Œé è¨ˆç®—å„ªæ–¼é‡è¤‡è¨ˆç®—ã€‚

### **ğŸ“ ç†æƒ³ç¯„æœ¬çš„è¨­è¨ˆæ¨¡å¼**

åŸºæ–¼å…©å€‹ç”Ÿæˆå™¨çš„å°æ¯”åˆ†æï¼Œæˆ‘å€‘æç…‰å‡ºç†æƒ³ç¯„æœ¬æ‡‰è©²å…·å‚™çš„ç‰¹å¾µï¼š

#### **åˆå§‹åŒ–éšæ®µ**ï¼š
```python
def __init__(self, options=None):
    # 1. èˆŠç‰ˆçš„ç°¡æ½”é…ç½® + åŸºæœ¬é©—è­‰
    self.options = self._validate_options(options)
    
    # 2. æ–°ç‰ˆçš„æ—¥èªŒç³»çµ±
    self.logger = get_logger(self.__class__.__name__)
    
    # 3. é¡Œå‹ç‰¹åŒ–çš„é è™•ç†ï¼ˆå¦‚æœé©ç”¨ï¼‰
    self._build_specialized_data()
```

#### **ç”Ÿæˆé‚è¼¯éšæ®µ**ï¼š
```python
def generate_question(self):
    # 1. æ–°ç‰ˆçš„ç•°å¸¸è™•ç†
    for attempt in range(max_attempts):
        try:
            # 2. èˆŠç‰ˆçš„ç›´æ¥é‚è¼¯
            result = self._generate_core_logic()
            if result:
                return result
        except Exception as e:
            self.logger.warning(f"å˜—è©¦å¤±æ•—: {e}")
    
    # 3. é è¨­æ©Ÿåˆ¶ç¢ºä¿ç©©å®šæ€§
    return self._get_fallback_question()
```

#### **è¿”å›çµæ§‹éšæ®µ**ï¼š
```python
def _build_complete_result(self):
    return {
        # æ ¸å¿ƒå…§å®¹
        "question": question,
        "answer": answer,
        "explanation": explanation,
        
        # ç³»çµ±å…¼å®¹æ€§ï¼ˆä¸å¯çœç•¥ï¼‰
        "size": self.get_question_size(),
        "difficulty": difficulty,
        "figure_data_question": figure_data,
        "figure_data_explanation": explanation_figure,
        "figure_position": "right"
    }
```

### **ğŸ¯ ç¯„æœ¬é¸æ“‡æŒ‡å°åŸå‰‡**

1. **ç°¡å–®é¡Œå‹**ï¼ˆåŸºç¤è¨ˆç®—ï¼‰ï¼šä»¥èˆŠç‰ˆç‚ºåŸºç¤ï¼ŒåŠ å…¥åŸºæœ¬ç•°å¸¸è™•ç†
2. **è¤‡é›œé¡Œå‹**ï¼ˆå¤šæ­¥é©Ÿè¨ˆç®—ï¼‰ï¼šèåˆå…©ç‰ˆå„ªé»ï¼Œä¿æŒæ¨¡çµ„åŒ–ä½†é¿å…éåº¦å·¥ç¨‹
3. **æ‰€æœ‰é¡Œå‹**ï¼šå¿…é ˆåŒ…å«å®Œæ•´çš„PDFå…¼å®¹æ¬„ä½å’ŒLaTeXæ ¼å¼

---

**æ’°å¯«æ—¥æœŸ**: 2025-09-11  
**åŸºæ–¼**: DoubleRadicalSimplificationGenerator + TrigonometricFunctionGenerator å°æ¯”åˆ†æ  
**å»ºè­°æ›´æ–°**: ç•¶æœ‰æ–°çš„ç”Ÿæˆå™¨å¯¦ç¾æ™‚ï¼Œè£œå……æœ¬æ–‡æª”çš„æ¡ˆä¾‹åˆ†æ