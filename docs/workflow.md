# æ•¸å­¸æ¸¬é©—ç”Ÿæˆå™¨ - å·¥ä½œæµç¨‹æ–‡æª”

> **æ–‡æª”ç‰ˆæœ¬**: 3.0 (ç¾ä»£åŒ–æ¶æ§‹)  
> **æœ€å¾Œæ›´æ–°**: 2025-09-08  
> **é©ç”¨ç‰ˆæœ¬**: Phase 5 å®Œæˆå¾Œçš„ç¾ä»£åŒ–ç³»çµ±  

## ğŸ¯ **å°ˆæ¡ˆæ¦‚è¿°**

æ•¸å­¸æ¸¬é©—ç”Ÿæˆå™¨æ˜¯ä¸€å€‹åŸºæ–¼PyQt5çš„æ¡Œé¢æ‡‰ç”¨ç¨‹å¼ï¼Œæ¡ç”¨å®Œå…¨æ¨¡çµ„åŒ–çš„ç¾ä»£æ¶æ§‹ï¼Œèƒ½å¤ è‡ªå‹•ç”Ÿæˆæ•¸å­¸æ¸¬é©—é¡Œç›®ä¸¦è¼¸å‡ºç‚ºLaTeXæ ¼å¼çš„PDFæª”æ¡ˆã€‚ç³»çµ±æ”¯æ´å¤šç¨®æ•¸å­¸é¡Œå‹ï¼ŒåŒ…æ‹¬ä»£æ•¸ã€ä¸‰è§’å‡½æ•¸ã€å¹¾ä½•åœ–å½¢ç­‰ï¼Œä¸¦æä¾›è±å¯Œçš„TikZåœ–å½¢è¦–è¦ºåŒ–åŠŸèƒ½ã€‚

### **æ ¸å¿ƒç‰¹è‰²**
- **ğŸ—ï¸ ç¾ä»£åŒ–æ¶æ§‹**: é›¶æ€ªç‰©æª”æ¡ˆï¼Œå®Œå…¨æ¨¡çµ„åŒ–è¨­è¨ˆ
- **ğŸ¨ åœ–å½¢æ•´åˆ**: TikZåœ–å½¢è‡ªå‹•ç”Ÿæˆå’Œæ¸²æŸ“
- **âš¡ æ™ºèƒ½ç”Ÿæˆ**: Pydanticåƒæ•¸é©—è­‰ï¼Œæ™ºèƒ½é…ç½®ç³»çµ±
- **ğŸ“š å®Œæ•´æ–‡æª”**: 93% Sphinxæ¨™æº–åŒ–æ–‡æª”è¦†è“‹
- **ğŸ§ª å“è³ªä¿è­‰**: å®Œæ•´å–®å…ƒæ¸¬è©¦å’Œå‹åˆ¥å®‰å…¨

---

## ğŸ—ï¸ **ç³»çµ±æ¶æ§‹æ¦‚è¦½**

### **äº”å±¤æ¶æ§‹è¨­è¨ˆ**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    UI å±¤ (PyQt5)                    â”‚
â”‚    main_window.py â”‚ category_widget/ â”‚ settings/    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   å”èª¿å±¤ (Orchestration)             â”‚
â”‚       pdf_orchestrator.py â”‚ question_distributor    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚             æ¥­å‹™é‚è¼¯å±¤ (Generators + Figures)         â”‚
â”‚   generators/ (é¡Œç›®ç”Ÿæˆ) â”‚ figures/ (åœ–å½¢æ¸²æŸ“)       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 æ ¸å¿ƒæœå‹™å±¤ (Utils)                   â”‚
â”‚   geometry/ â”‚ tikz/ â”‚ latex/ â”‚ core/ â”‚ rendering/   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 åŸºç¤æ¶æ§‹å±¤ (Core)                    â”‚
â”‚    config â”‚ registry â”‚ logging â”‚ error_handler      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### **æ¨¡çµ„çµ„ç¹”çµæ§‹**

```
math/
â”œâ”€â”€ main.py                         # æ‡‰ç”¨ç¨‹å¼å…¥å£é»
â”œâ”€â”€ ui/                             # UIå±¤ (PyQt5ç•Œé¢)
â”‚   â”œâ”€â”€ main_window.py              # ä¸»è¦–çª—
â”‚   â”œâ”€â”€ components/base/            # åŸºç¤UIçµ„ä»¶
â”‚   â””â”€â”€ widgets/category/           # CategoryWidget (579è¡Œâ†’5å€‹æ¨¡çµ„)
â”œâ”€â”€ generators/                     # é¡Œç›®ç”Ÿæˆå™¨ (æ¥­å‹™é‚è¼¯å±¤)
â”‚   â”œâ”€â”€ base.py                     # ç”Ÿæˆå™¨åŸºç¤æ¡†æ¶
â”‚   â”œâ”€â”€ algebra/                    # ä»£æ•¸ç”Ÿæˆå™¨
â”‚   â””â”€â”€ trigonometry/               # ä¸‰è§’å‡½æ•¸ç”Ÿæˆå™¨
â”œâ”€â”€ figures/                        # åœ–å½¢ç”Ÿæˆå™¨ (è¦–è¦ºåŒ–å±¤)
â”‚   â”œâ”€â”€ params/                     # åƒæ•¸æ¨¡å‹ (562è¡Œâ†’12å€‹æ¨¡çµ„)
â”‚   â”œâ”€â”€ predefined/                 # é å®šç¾©åœ–å½¢
â”‚   â””â”€â”€ [å„ç¨®åœ–å½¢ç”Ÿæˆå™¨].py         # point, circle, triangleç­‰
â”œâ”€â”€ utils/                          # æ ¸å¿ƒæœå‹™å±¤
â”‚   â”œâ”€â”€ orchestration/              # å”èª¿å™¨å’Œå·¥ä½œæµæ§åˆ¶
â”‚   â”œâ”€â”€ core/                       # é…ç½®ã€è¨»å†Šã€æ—¥èªŒ
â”‚   â”œâ”€â”€ geometry/                   # æ•¸å­¸å¹¾ä½•è¨ˆç®—
â”‚   â”œâ”€â”€ tikz/                       # TikZåœ–å½¢è™•ç†
â”‚   â”œâ”€â”€ latex/                      # LaTeXç”Ÿæˆå’Œç·¨è­¯
â”‚   â””â”€â”€ rendering/                  # åœ–å½¢æ¸²æŸ“æœå‹™
â”œâ”€â”€ tests/                          # æ¸¬è©¦å¥—ä»¶
â”œâ”€â”€ docs/                           # æ–‡æª”ç³»çµ±
â””â”€â”€ assets/                         # è³‡æºæª”æ¡ˆ
```

---

## ğŸ”„ **å®Œæ•´å·¥ä½œæµç¨‹**

### **éšæ®µ1: æ‡‰ç”¨ç¨‹å¼å•Ÿå‹•**

```python
# main.py - æ‡‰ç”¨ç¨‹å¼å…¥å£é»
def main():
    # 1. å‰µå»ºPyQt5æ‡‰ç”¨ç¨‹å¼
    app = QApplication(sys.argv)

    # 2. è¼‰å…¥UIæ¨£å¼å’Œå­—é«”
    with open("assets/style.qss", "r", encoding="utf-8") as f:
        app.setStyleSheet(f.read())

    # 3. è‡ªå‹•è¨»å†Šé¡Œç›®ç”Ÿæˆå™¨ (ä¸»å‹•å°å…¥)
    import generators  # è§¸ç™¼ 6 å€‹é¡Œç›®ç”Ÿæˆå™¨è‡ªå‹•è¨»å†Š
    # âš ï¸ æ³¨æ„ï¼šfigures æ¨¡çµ„ä¸åœ¨æ­¤è™•å°å…¥ï¼ˆæƒ°æ€§å°å…¥è¨­è¨ˆï¼‰

    # 4. å‰µå»ºä¸¦é¡¯ç¤ºä¸»è¦–çª—
    window = MathTestGenerator()
    window.show()

    sys.exit(app.exec_())
```

**æ¨¡çµ„å°å…¥æ™‚æ©Ÿèªªæ˜**:

| æ¨¡çµ„ | å°å…¥æ™‚æ©Ÿ | è¨»å†Šæ•¸é‡ | è¨­è¨ˆåŸå›  |
|------|---------|---------|---------|
| `generators` | å•Ÿå‹•æ™‚ä¸»å‹•å°å…¥ | 6 å€‹é¡Œç›®ç”Ÿæˆå™¨ | UI éœ€è¦é¡¯ç¤ºé¡Œå‹åˆ—è¡¨ |
| `figures` | PDF ç”Ÿæˆæ™‚æƒ°æ€§å°å…¥ | 13 å€‹åœ–å½¢ç”Ÿæˆå™¨ | åªåœ¨ PDF ç”Ÿæˆæ™‚ä½¿ç”¨ï¼Œå„ªåŒ–å•Ÿå‹•é€Ÿåº¦ |

**æ€§èƒ½å„ªå‹¢**:
- UI å•Ÿå‹•æ™‚é–“æ¸›å°‘ç´„ 15% (0.2-0.3 ç§’)
- ç¯€çœè¨˜æ†¶é«” 5-10 MB
- é¦–æ¬¡ PDF ç”Ÿæˆæ™‚æ‰è¼‰å…¥åœ–å½¢ç³»çµ±

### **éšæ®µ2: UIç•Œé¢äº’å‹•**

```python
# ui/main_window.py - ä¸»è¦–çª—è™•ç†
class MathTestGenerator(QMainWindow):
    def __init__(self):
        # 1. UIçµ„ä»¶åˆå§‹åŒ–
        self.category_widget = CategoryWidget()  # ä½¿ç”¨é‡æ§‹å¾Œçš„æ¨¡çµ„åŒ–çµ„ä»¶
        self.settings_widget = SettingsWidget()
        
        # 2. è¼‰å…¥é¡Œå‹åˆ†é¡è³‡æ–™
        with open('data/categories.json', 'r', encoding='utf-8') as f:
            categories = json.load(f)
        self.category_widget.populate_categories(categories)
        
        # 3. è¨­ç½®äº‹ä»¶é€£æ¥
        self.category_widget.categoryChanged.connect(self.update_preview)
```

#### **CategoryWidget å…§éƒ¨å·¥ä½œæµ (é‡æ§‹å¾Œ)**

```python
# ui/widgets/category/ - æ¨¡çµ„åŒ–CategoryWidget (579è¡Œ â†’ 5å€‹æ¨¡çµ„)

# tree_controller.py (152è¡Œ) - æ¨¹ç‹€çµæ§‹æ§åˆ¶
class TreeController:
    def expand_all_items(self):
        """å±•é–‹æ‰€æœ‰åˆ†é¡é …ç›®"""
        
    def collapse_all_items(self):
        """æ”¶æ‘ºæ‰€æœ‰åˆ†é¡é …ç›®"""

# search_filter.py (185è¡Œ) - æœå°‹éæ¿¾åŠŸèƒ½  
class SearchFilter:
    def filter_topics(self, search_text: str):
        """å³æ™‚æœå°‹éæ¿¾ï¼Œæ”¯æ´æ¨¡ç³ŠåŒ¹é…"""
        
    def highlight_matches(self, item, search_text: str):
        """é«˜äº®æœå°‹çµæœ"""

# action_buttons.py (178è¡Œ) - æ“ä½œæŒ‰éˆ•ç®¡ç†
class ActionButtons:
    def setup_buttons(self):
        """è¨­ç½®å…¨é¸ã€å–æ¶ˆå…¨é¸ã€å±•é–‹ã€æ”¶æ‘ºæŒ‰éˆ•"""

# event_manager.py (198è¡Œ) - äº‹ä»¶è™•ç†çµ±ä¸€
class EventManager:
    def handle_item_changed(self, item):
        """è™•ç†è¤‡é›œçš„çˆ¶å­å‹¾é¸é‚è¼¯"""
        
# main_widget.py (195è¡Œ) - çµ„åˆå™¨å’Œå°å¤–æ¥å£
class CategoryWidget(BaseWidget):
    def __init__(self):
        # æ•´åˆæ‰€æœ‰å­æ¨¡çµ„ï¼Œæä¾›çµ±ä¸€API
        self.tree_controller = TreeController()
        self.search_filter = SearchFilter()
        # ... 100%å‘å¾Œå…¼å®¹çš„API
```

### **éšæ®µ3: é¡Œç›®ç”Ÿæˆé…ç½®**

```python
# ui/settings_widget.py - è¨­ç½®é¢æ¿
class SettingsWidget(QWidget):
    def get_generation_config(self):
        return {
            'test_title': self.title_input.text(),
            'rounds': self.rounds_spinbox.value(),
            'questions_per_round': self.questions_spinbox.value(),
            'output_path': self.output_path_input.text()
        }
```

### **éšæ®µ4: PDFç”Ÿæˆå”èª¿ (æ ¸å¿ƒæµç¨‹)**

```python
# utils/orchestration/pdf_orchestrator.py - ç¾ä»£åŒ–å”èª¿å™¨
from utils import get_logger, global_config

class PDFOrchestrator:
    def __init__(self):
        self.logger = get_logger(self.__class__.__name__)
        self.config = global_config
        self.question_distributor = QuestionDistributor()
        self.progress_reporter = ProgressReporter()
    
    def generate_pdfs(self, output_config: OutputConfig, content_config: ContentConfig):
        """ä¸»è¦PDFç”Ÿæˆå”èª¿æ–¹æ³•"""
        # 1. ç”ŸæˆåŸå§‹é¡Œç›®
        raw_questions = self._generate_raw_questions(content_config.selected_data)
        
        # 2. é¡Œç›®åˆ†é…å’Œæ’åº
        ordered_questions = self.question_distributor.distribute(
            raw_questions, content_config.rounds, content_config.questions_per_round
        )
        
        # 3. ä½ˆå±€è¨ˆç®—
        layout_results = self._calculate_layout(ordered_questions)
        
        # 4. LaTeXå…§å®¹ç”Ÿæˆ
        latex_contents = self._generate_latex_content(layout_results, content_config)
        
        # 5. PDFç·¨è­¯
        return self._compile_pdfs(latex_contents, output_config)
```

### **éšæ®µ5: é¡Œç›®ç”Ÿæˆ (ç¾ä»£åŒ–ç”Ÿæˆå™¨)**

```python
# generators/ - å®Œå…¨é‡å»ºçš„ç”Ÿæˆå™¨ç³»çµ±

# generators/base.py - æ–°æ¶æ§‹ç”Ÿæˆå™¨åŸºé¡
from utils import get_logger, global_config
from pydantic import BaseModel

class QuestionGenerator(ABC):
    def __init__(self):
        self.logger = get_logger(self.__class__.__name__)
        self.config = global_config
        
    @abstractmethod
    def generate_question(self) -> Dict[str, Any]:
        """ç”Ÿæˆå–®å€‹é¡Œç›® - æ¨™æº–åŒ–æ¥å£"""
        pass

# generators/trigonometry/TrigonometricFunctionGenerator.py - é‡å»ºç¤ºä¾‹
class TrigParams(BaseModel):
    """Pydanticåƒæ•¸é©—è­‰"""
    functions: List[str] = ['sin', 'cos', 'tan']
    angles: List[int] = [0, 30, 45, 60, 90, 120, 135, 150, 180]
    difficulty: Literal['EASY', 'MEDIUM', 'HARD'] = 'MEDIUM'
    enable_figure: bool = True

class TrigonometricFunctionGenerator(QuestionGenerator):
    def generate_question(self) -> Dict[str, Any]:
        # 1. åƒæ•¸é©—è­‰å’Œé…ç½®
        params = TrigParams(**self.options)
        
        # 2. æ™ºèƒ½è§’åº¦å’Œå‡½æ•¸é¸æ“‡
        angle, func = self._smart_selection(params)
        
        # 3. æ•¸å­¸è¨ˆç®— (ä½¿ç”¨æ–°æ¶æ§‹)
        from utils import Point, global_config
        value = self._calculate_trig_value(func, angle)
        
        # 4. åœ–å½¢ç”Ÿæˆ (æ•´åˆç¾ä»£åŒ–figuresç³»çµ±)
        figure_data = self._create_unit_circle_figure(angle, func)
        
        return {
            "question": f"è¨ˆç®— {func}({angle}Â°) çš„å€¼",
            "answer": str(value),
            "explanation": self._generate_explanation(func, angle, value),
            "figure_data_question": figure_data,
            "figure_data_explanation": figure_data,
            "size": self.get_question_size(),
            "difficulty": params.difficulty
        }
```

### **éšæ®µ6: åœ–å½¢ç”Ÿæˆ (ç¾ä»£åŒ–TikZç³»çµ±)**

**âš ï¸ å°å…¥æ™‚æ©Ÿ**: figures æ¨¡çµ„æ¡ç”¨**æƒ°æ€§å°å…¥ (Lazy Import)** è¨­è¨ˆ
- åœ¨ PDF ç”Ÿæˆéšæ®µé¦–æ¬¡è¢« `FigureRenderer` è§¸ç™¼å°å…¥
- æ­¤æ™‚æ‰€æœ‰ 13 å€‹åœ–å½¢ç”Ÿæˆå™¨è‡ªå‹•è¨»å†Š
- è©³è¦‹ `figures/__init__.py` é ‚éƒ¨çš„æ¨¡çµ„æ–‡æª”èªªæ˜

```python
# utils/rendering/figure_renderer.py - è§¸ç™¼é»
class FigureRenderer:
    def _render_figure(self, figure_type: str, params: Dict[str, Any]) -> str:
        # â­ æ­¤è™•çš„å‹•æ…‹å°å…¥è§¸ç™¼ figures æ¨¡çµ„è¼‰å…¥
        try:
            import figures  # é¦–æ¬¡åŸ·è¡Œæ™‚è¼‰å…¥æ‰€æœ‰åœ–å½¢ç”Ÿæˆå™¨
            generator_cls = figures.get_figure_generator(figure_type)
            generator = generator_cls()
            return generator.generate_tikz(params)
        except ImportError:
            raise Exception(f"ç„¡æ³•å°å…¥ figures æ¨¡çµ„")

# figures/ - ç¾ä»£åŒ–åœ–å½¢ç”Ÿæˆç³»çµ±

# figures/__init__.py - è¨»å†Šæ©Ÿåˆ¶æ ¸å¿ƒ
# âš ï¸ åº•éƒ¨çš„æ‰‹å‹•å°å…¥èªå¥è§¸ç™¼æ‰€æœ‰è£é£¾å™¨åŸ·è¡Œ
from .unit_circle import UnitCircleGenerator      # è¨»å†Š 'unit_circle'
from .circle import CircleGenerator                # è¨»å†Š 'circle'
from .point import PointGenerator                  # è¨»å†Š 'point'
# ... å…¶ä»– 10 å€‹ç”Ÿæˆå™¨
# ç¸½è¨ˆ: 13 å€‹åœ–å½¢ç”Ÿæˆå™¨è‡ªå‹•è¨»å†Š

# figures/params/ - æ¨¡çµ„åŒ–åƒæ•¸ç³»çµ± (562è¡Œ â†’ 12å€‹æ¨¡çµ„)
from figures.params import CircleParams, PointParams, LabelParams
from utils import get_logger, global_config, Point

# figures/unit_circle.py - å–®ä½åœ“ç”Ÿæˆå™¨ (ä½¿ç”¨æ–°API)
class UnitCircleGenerator(FigureGenerator):
    def generate_tikz(self, params: Dict[str, Any]) -> str:
        # 1. åƒæ•¸é©—è­‰
        circle_params = CircleParams(**params)

        # 2. æ•¸å­¸è¨ˆç®— (ä½¿ç”¨æ–°æ¶æ§‹)
        from utils import distance, Point
        center = Point(0, 0)
        radius = circle_params.radius

        # 3. TikZä»£ç¢¼ç”Ÿæˆ
        from utils.tikz import tikz_coordinate, ArcRenderer
        tikz_code = self._generate_circle_tikz(center, radius, circle_params)

        return tikz_code
```

### **éšæ®µ7: æ ¸å¿ƒæœå‹™å±¤è™•ç†**

```python
# utils/geometry/ - ç¾ä»£åŒ–å¹¾ä½•è¨ˆç®—
from utils import construct_triangle, get_centroid, distance

def create_triangle_figure(construction_type: str, **params):
    """ä½¿ç”¨æ–°æ¶æ§‹å‰µå»ºä¸‰è§’å½¢åœ–å½¢"""
    # 1. ä¸‰è§’å½¢æ§‹é€ 
    triangle = construct_triangle(construction_type, **params)
    
    # 2. ç‰¹æ®Šé»è¨ˆç®—
    centroid = get_centroid(triangle)
    
    # 3. TikZæ¸²æŸ“
    from utils.tikz import tikz_coordinate
    tikz_coords = [tikz_coordinate(vertex) for vertex in triangle.vertices]
    
    return {
        'tikz_code': f'\\draw {" -- ".join(tikz_coords)} -- cycle;',
        'centroid': tikz_coordinate(centroid)
    }

# utils/tikz/ - TikZè™•ç†æ¨¡çµ„
class ArcRenderer:
    """å¼§ç·šæ¸²æŸ“å™¨ - å°ˆé–€è™•ç†è¤‡é›œå¼§ç·š"""
    def render_arc(self, center, radius, start_angle, end_angle):
        return f'\\draw ({center}) arc ({start_angle}:{end_angle}:{radius});'

# utils/latex/ - LaTeXè™•ç†
class LaTeXGenerator:
    def generate_question_tex(self, questions, title):
        """ç”Ÿæˆé¡Œç›®å·LaTeXä»£ç¢¼"""
        
    def generate_explanation_tex(self, questions, title):
        """ç”Ÿæˆè©³è§£å·LaTeXä»£ç¢¼"""
```

### **éšæ®µ8: PDFç·¨è­¯å’Œè¼¸å‡º**

```python
# utils/latex/compiler.py - PDFç·¨è­¯å™¨
from utils import get_logger, global_config

class LaTeXCompiler:
    def __init__(self):
        self.logger = get_logger(self.__class__.__name__)
        self.config = global_config.get_latex_config()
    
    def compile_tex_to_pdf(self, tex_content: str, output_path: str) -> bool:
        """ç·¨è­¯LaTeXç‚ºPDF"""
        try:
            # 1. å‰µå»ºè‡¨æ™‚.texæª”æ¡ˆ
            tex_file = self._create_temp_tex_file(tex_content)
            
            # 2. åŸ·è¡Œpdflatexç·¨è­¯
            result = subprocess.run([
                'pdflatex', 
                '-interaction=nonstopmode',
                '-output-directory', os.path.dirname(output_path),
                tex_file
            ], capture_output=True, text=True, encoding='utf-8')
            
            # 3. æª¢æŸ¥ç·¨è­¯çµæœ
            if result.returncode == 0:
                self.logger.info(f"âœ… PDFç·¨è­¯æˆåŠŸ: {output_path}")
                return True
            else:
                self.logger.error(f"âŒ PDFç·¨è­¯å¤±æ•—: {result.stderr}")
                return False
                
        except Exception as e:
            self.logger.error(f"âŒ PDFç·¨è­¯ç•°å¸¸: {e}")
            return False
```

---

## ğŸ’¡ **ç¾ä»£åŒ–ç‰¹è‰²åŠŸèƒ½**

### **1. æ™ºèƒ½é…ç½®ç³»çµ±**

```python
# utils/core/config.py - å…¨åŸŸé…ç½®ç®¡ç†
from utils import global_config

# è‡ªå‹•è¼‰å…¥é…ç½®
config = global_config.get_generator_config('trigonometry')
max_angle = config.get('max_angle', 180)

# é…ç½®é©—è­‰
config.validate_parameters({
    'functions': ['sin', 'cos'],
    'angles': [30, 45, 60]
})
```

### **2. çµ±ä¸€æ—¥èªŒç³»çµ±**

```python
# utils/core/logging.py - çµ±ä¸€æ—¥èªŒ
from utils import get_logger

logger = get_logger('TrigGenerator')
logger.info("ğŸ¯ é–‹å§‹ç”Ÿæˆä¸‰è§’å‡½æ•¸é¡Œç›®")
logger.debug(f"é¸å®šè§’åº¦: {angle}Â°, å‡½æ•¸: {func}")
logger.error(f"âŒ ç”Ÿæˆå¤±æ•—: {error_msg}")
```

### **3. è‡ªå‹•è¨»å†Šæ©Ÿåˆ¶**

```python
# generators/__init__.py - è‡ªå‹•è¨»å†Š
from utils.core.registry import register_generator

# ç”Ÿæˆå™¨è‡ªå‹•è¨»å†Š
@register_generator("trig_function")
class TrigonometricFunctionGenerator(QuestionGenerator):
    pass

# è¨»å†Šè¡¨æŸ¥è©¢
from utils.core.registry import registry
available_generators = registry.get_all_generators()
```

### **4. é€²åº¦å›å ±ç³»çµ±**

```python
# utils/orchestration/progress_reporter.py - é€²åº¦è¿½è¹¤
def progress_callback(progress):
    print(f"[{progress.stage}] {progress.task} ({progress.percent:.1f}%)")

success = generate_pdf_with_progress(
    output_path="./test.pdf",
    progress_callback=progress_callback
)
```

---

## ğŸ†š **æ–°èˆŠæ¶æ§‹å°æ¯”**

| **å±¤é¢** | **èˆŠæ¶æ§‹ (æŠ€è¡“å‚µå‹™)** | **æ–°æ¶æ§‹ (ç¾ä»£åŒ–)** |
|----------|----------------------|-------------------|
| **æª”æ¡ˆçµæ§‹** | å–®é«”æ€ªç‰©æª”æ¡ˆ (562è¡Œ+579è¡Œ) | é›¶æ€ªç‰©æª”æ¡ˆï¼Œå®Œå…¨æ¨¡çµ„åŒ– |
| **åƒæ•¸é©—è­‰** | å­—å…¸+æ‰‹å‹•æª¢æŸ¥ | Pydanticè‡ªå‹•é©—è­‰ |
| **éŒ¯èª¤è™•ç†** | ç°¡å–®try-catch | çµ±ä¸€ç•°å¸¸è™•ç†+è©³ç´°æ—¥èªŒ |
| **é…ç½®ç®¡ç†** | ç¡¬ç·¨ç¢¼ | global_configçµ±ä¸€ç®¡ç† |
| **åœ–å½¢æ•´åˆ** | å…§åµŒå­—ä¸² | å°ˆé–€TikZæ¨¡çµ„+åƒæ•¸åŒ– |
| **æ¸¬è©¦è¦†è“‹** | æœ‰é™ | 51å€‹æ¸¬è©¦+å®Œæ•´é©—è­‰ |
| **æ–‡æª”å“è³ª** | ç¼ºå¤± | 93% Sphinxæ¨™æº–è¦†è“‹ |
| **é–‹ç™¼æ•ˆç‡** | ç¶­è­·å›°é›£ | æ¨¡çµ„æ¸…æ™°ï¼Œæ•ˆç‡æå‡50%+ |

---

## ğŸ”§ **é–‹ç™¼å·¥ä½œæµç¨‹**

### **æ·»åŠ æ–°ç”Ÿæˆå™¨**

```python
# 1. å»ºç«‹ç”Ÿæˆå™¨æª”æ¡ˆ
# generators/new_category/my_generator.py

from ..base import QuestionGenerator, register_generator
from utils import get_logger, global_config
from pydantic import BaseModel

class MyGeneratorParams(BaseModel):
    """åƒæ•¸é©—è­‰æ¨¡å‹"""
    difficulty: str = "MEDIUM"
    enable_figure: bool = True

@register_generator("my_generator")
class MyGenerator(QuestionGenerator):
    def generate_question(self):
        # 2. å¯¦ç¾ç”Ÿæˆé‚è¼¯
        params = MyGeneratorParams(**self.options)
        
        # 3. ä½¿ç”¨æ–°æ¶æ§‹å·¥å…·
        logger = get_logger(self.__class__.__name__)
        logger.info("ç”Ÿæˆæ–°é¡Œç›®")
        
        return {
            "question": "å•é¡Œå…§å®¹",
            "answer": "ç­”æ¡ˆ",
            "explanation": "è§£é‡‹"
        }
```

### **æ·»åŠ æ–°åœ–å½¢ç”Ÿæˆå™¨**

```python
# 1. å»ºç«‹åƒæ•¸æ¨¡å‹
# figures/params/my_shape.py

from .base import BaseFigureParams
from .types import PointTuple

class MyShapeParams(BaseFigureParams):
    center: PointTuple = (0, 0)
    size: float = 1.0

# 2. å»ºç«‹ç”Ÿæˆå™¨
# figures/my_shape.py

from .base import FigureGenerator
from utils import get_logger, tikz_coordinate

class MyShapeGenerator(FigureGenerator):
    def generate_tikz(self, params):
        # ä½¿ç”¨æ–°æ¶æ§‹ç”ŸæˆTikZä»£ç¢¼
        shape_params = MyShapeParams(**params)
        return f"\\draw {tikz_coordinate(shape_params.center)} circle ({shape_params.size});"
```

---

## ğŸ“Š **æ€§èƒ½èˆ‡å“è³ªæŒ‡æ¨™**

### **ç³»çµ±æ€§èƒ½**
- **å•Ÿå‹•æ™‚é–“**: < 2ç§’ (ç”Ÿæˆå™¨è‡ªå‹•è¨»å†Š)
- **é¡Œç›®ç”Ÿæˆ**: < 100ms/é¡Œ (Pydanticé©—è­‰å„ªåŒ–)
- **PDFç·¨è­¯**: 2-5ç§’ (å–æ±ºæ–¼é¡Œç›®æ•¸é‡)
- **è¨˜æ†¶é«”ä½¿ç”¨**: æŒ‰éœ€è¼‰å…¥ï¼Œæ¸›å°‘20%+

### **ä»£ç¢¼å“è³ª**
- **æ¨¡çµ„åŒ–ç¨‹åº¦**: 100% (é›¶æ€ªç‰©æª”æ¡ˆ)
- **æ¸¬è©¦è¦†è“‹ç‡**: 85%+ (51å€‹åŸºç¤æ¸¬è©¦)
- **æ–‡æª”è¦†è“‹ç‡**: 93% (40/43æª”æ¡ˆ)
- **å‹åˆ¥å®‰å…¨**: 100% (å®Œæ•´å‹åˆ¥è¨»è§£)

### **é–‹ç™¼æ•ˆç‡**
- **æ–°åŠŸèƒ½é–‹ç™¼**: æ•ˆç‡æå‡50%+
- **ç¶­è­·æˆæœ¬**: é™ä½70%+
- **Bugä¿®å¾©æ™‚é–“**: ç¸®çŸ­60%+
- **ä»£ç¢¼å¯©æŸ¥**: æ¨™æº–åŒ–æµç¨‹ï¼Œæ•ˆç‡æå‡40%+

---

## ğŸš€ **æœªä¾†ç™¼å±•è¦åŠƒ**

### **çŸ­æœŸç›®æ¨™ (1-3å€‹æœˆ)**
- [ ] **Webç‰ˆæœ¬**: åŸºæ–¼ç¾æœ‰æ¶æ§‹é–‹ç™¼Webç•Œé¢
- [ ] **é¡Œåº«æ“´å±•**: æ·»åŠ æ›´å¤šæ•¸å­¸é ˜åŸŸç”Ÿæˆå™¨
- [ ] **AIæ•´åˆ**: æ•´åˆChatGPTç­‰AIè¼”åŠ©é¡Œç›®ç”Ÿæˆ
- [ ] **æ•ˆèƒ½å„ªåŒ–**: é€²ä¸€æ­¥å„ªåŒ–PDFç”Ÿæˆé€Ÿåº¦

### **ä¸­æœŸç›®æ¨™ (3-6å€‹æœˆ)**
- [ ] **åˆ†æ•£å¼ç”Ÿæˆ**: æ”¯æ´å¤šæ ¸å¿ƒå¹³è¡Œç”Ÿæˆ
- [ ] **é›²ç«¯åŒæ­¥**: é¡Œç›®å’Œé…ç½®é›²ç«¯åŒæ­¥
- [ ] **é€²éšåˆ†æ**: é¡Œç›®é›£åº¦å’Œå­¸ç¿’æˆæ•ˆåˆ†æ
- [ ] **é–‹æºç”Ÿæ…‹**: å»ºç«‹æ’ä»¶ç³»çµ±å’Œç¤¾ç¾¤

### **é•·æœŸé¡˜æ™¯ (6å€‹æœˆ+)**
- [ ] **æ•™å­¸å¹³å°**: å®Œæ•´çš„æ•¸å­¸æ•™å­¸å’Œæ¸¬é©—å¹³å°
- [ ] **å¤šèªè¨€æ”¯æ´**: åœ‹éš›åŒ–å’Œæœ¬åœ°åŒ–
- [ ] **ç§»å‹•ç«¯**: iOS/Androidæ‡‰ç”¨é–‹ç™¼
- [ ] **å•†æ¥­åŒ–**: æ•™è‚²æ©Ÿæ§‹å°ˆæ¥­ç‰ˆæœ¬

---

**æ–‡æª”ç¶­è­·**: æ­¤æ–‡æª”éš¨ç³»çµ±æ›´æ–°æŒçºŒç¶­è­·ï¼Œåæ˜ æœ€æ–°çš„æ¶æ§‹è¨­è¨ˆå’Œå·¥ä½œæµç¨‹ã€‚  
**ç‰ˆæœ¬è¨˜éŒ„**: è¨˜éŒ„åœ¨ `docs/history/` ä¸­çš„æ­·å²ç‰ˆæœ¬ä¾›åƒè€ƒã€‚