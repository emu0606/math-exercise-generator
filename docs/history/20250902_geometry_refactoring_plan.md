# 20250902 - Utils æ¨¡çµ„å…¨é¢é‡æ§‹å·¥ä½œè¨ˆç•«

> **æ–‡æª”é¡žåž‹**: æ­·å²æª”æ¡ˆ - æ—©æœŸé‡æ§‹è¨ˆç•«  
> **å‰µå»ºæ™‚é–“**: 2025-09-02  
> **ç‹€æ…‹**: æ­·å²åƒè€ƒæ–‡æª”  
> **æ­·å²æ„ç¾©**: æ—©æœŸutilsæ¨¡çµ„é‡æ§‹çš„å®Œæ•´è¨ˆç•«ï¼Œç‚ºå¾ŒçºŒç¾ä»£åŒ–å·¥ä½œå¥ å®šåŸºç¤Ž  
> **æ­¸æª”åŽŸå› **: é‡æ§‹å·¥ä½œå·²å®Œæˆï¼Œä¿ç•™ä½œç‚ºæ­·å²è¨˜éŒ„

## å°ˆæ¡ˆèƒŒæ™¯

ç•¶å‰ `utils/` æ¨¡çµ„å­˜åœ¨å¤šé‡å•é¡Œï¼š
1. **`geometry_utils.py` éŽæ–¼é¾å¤§**ï¼ˆ969 è¡Œï¼‰ï¼ŒåŠŸèƒ½æ··é›œä¸”æœªå®Œå·¥
2. **ä»£ç¢¼å“è³ªå•é¡Œ**ï¼šèª¿è©¦è¼¸å‡ºæ´©æ¼ã€é‡è¤‡ä»£ç¢¼ã€è‡¨æ™‚è¨»é‡‹
3. **æž¶æ§‹è¨­è¨ˆå•é¡Œ**ï¼šè·è²¬ä¸æ˜Žã€ä¾è³´æ··äº‚ã€è€¦åˆåº¦é«˜
4. **ç¼ºä¹çµ±ä¸€æ¨™æº–**ï¼šæ—¥èªŒç³»çµ±ä¸ä¸€è‡´ã€é…ç½®ç®¡ç†åˆ†æ•£

## é‡æ§‹ç›®æ¨™

1. **åˆ†é›¢è·è²¬**ï¼šå°‡ç´”æ•¸å­¸è¨ˆç®—èˆ‡æ¸²æŸ“è¼”åŠ©åˆ†é›¢
2. **æå‡å“è³ª**ï¼šçµ±ä¸€ä»£ç¢¼æ¨™æº–ã€æ—¥èªŒç³»çµ±ã€éŒ¯èª¤è™•ç†
3. **æ¨¡çµ„åŒ–è¨­è¨ˆ**ï¼šæ¸…æ™°çš„ä¾è³´é—œä¿‚ã€å¯æ¸¬è©¦çš„æž¶æ§‹
4. **å¼•å…¥å°ˆæ¥­å·¥å…·**ï¼šä½¿ç”¨ NumPy/SymPy æå‡è¨ˆç®—èƒ½åŠ›
5. **ä¿æŒç›¸å®¹æ€§**ï¼šç¢ºä¿ç¾æœ‰åŠŸèƒ½æ­£å¸¸é‹ä½œ

## æ–°æž¶æ§‹è¨­è¨ˆ

```
utils/
â”œâ”€â”€ __init__.py                    # çµ±ä¸€å…¥å£ï¼Œå‘å¾Œç›¸å®¹æŽ¥å£
â”œâ”€â”€ core/                         # æ ¸å¿ƒåŠŸèƒ½æ¨¡çµ„
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ registry.py               # æ¸…ç†å¾Œçš„è¨»å†Šç³»çµ±
â”‚   â”œâ”€â”€ layout_engine.py          # é‡æ§‹çš„ä½ˆå±€å¼•æ“Ž  
â”‚   â”œâ”€â”€ config.py                 # çµ±ä¸€é…ç½®ç®¡ç†
â”‚   â””â”€â”€ logging.py                # çµ±ä¸€æ—¥èªŒç³»çµ±
â”œâ”€â”€ geometry/                     # ç´”æ•¸å­¸å¹¾ä½•è¨ˆç®—
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ basic_ops.py              # åŸºç¤Žé‹ç®—
â”‚   â”œâ”€â”€ triangle_construction.py  # ä¸‰è§’å½¢æ§‹é€ 
â”‚   â”œâ”€â”€ triangle_centers.py       # ä¸‰è§’å½¢ç‰¹æ®Šé»ž
â”‚   â”œâ”€â”€ vector_ops.py             # å‘é‡é‹ç®—
â”‚   â”œâ”€â”€ circle_ops.py             # åœ“ç›¸é—œè¨ˆç®—
â”‚   â”œâ”€â”€ math_backend.py           # NumPy/SymPy é›†æˆ
â”‚   â”œâ”€â”€ types.py                  # å¹¾ä½•é¡žåž‹å®šç¾©
â”‚   â””â”€â”€ exceptions.py             # å¹¾ä½•ç•°å¸¸
â”œâ”€â”€ tikz/                         # TikZ/LaTeX æ¸²æŸ“è¼”åŠ©
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ label_positioning.py      # æ¨™ç±¤å®šä½ç­–ç•¥
â”‚   â”œâ”€â”€ arc_parameters.py         # è§’å¼§åƒæ•¸è¨ˆç®—
â”‚   â”œâ”€â”€ coordinate_transform.py   # åº§æ¨™è½‰æ›
â”‚   â”œâ”€â”€ layout_helpers.py         # ä½ˆå±€è¼”åŠ©
â”‚   â”œâ”€â”€ types.py                  # TikZ é¡žåž‹å®šç¾©
â”‚   â””â”€â”€ exceptions.py             # TikZ ç•°å¸¸
â”œâ”€â”€ latex/                        # LaTeX æ–‡æª”ç”Ÿæˆ
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ generator.py              # é‡æ§‹çš„ LaTeX ç”Ÿæˆå™¨
â”‚   â”œâ”€â”€ compiler.py               # æ”¹é€²çš„ PDF ç·¨è­¯å™¨
â”‚   â”œâ”€â”€ structure.py              # æ¸…ç†çš„æ–‡æª”çµæ§‹
â”‚   â”œâ”€â”€ config.py                 # LaTeX é…ç½®
â”‚   â””â”€â”€ escape.py                 # è½‰ç¾©å·¥å…·
â”œâ”€â”€ rendering/                    # åœ–å½¢æ¸²æŸ“
â”‚   â”œâ”€â”€ __init__.py
â”‚   â””â”€â”€ figure_renderer.py        # è§£è€¦çš„åœ–å½¢æ¸²æŸ“å™¨
â””â”€â”€ orchestration/                # æ¥­å‹™å”èª¿å±¤
    â”œâ”€â”€ __init__.py
    â””â”€â”€ pdf_generator.py          # é‡æ§‹çš„ PDF ç”Ÿæˆå”èª¿å™¨
```

## æ•¸å­¸åº«é›†æˆç­–ç•¥

### æ ¸å¿ƒæ•¸å­¸åº«é¸æ“‡
- **NumPy**ï¼šé«˜æ•ˆæ•¸å€¼è¨ˆç®—ã€å‘é‡é‹ç®—
- **SymPy**ï¼šç¬¦è™Ÿæ•¸å­¸ã€ç²¾ç¢ºå¹¾ä½•è¨ˆç®—
- **Math**ï¼šåŸºç¤Žæ•¸å­¸å‡½æ•¸

### é›†æˆåŽŸå‰‡
1. **æ€§èƒ½å„ªå…ˆ**ï¼šæ•¸å€¼å¯†é›†è¨ˆç®—ä½¿ç”¨ NumPy
2. **ç²¾åº¦å„ªå…ˆ**ï¼šç¬¦è™Ÿè¨ˆç®—å’Œç²¾ç¢ºçµæžœä½¿ç”¨ SymPy
3. **é¸æ“‡æ€§ä½¿ç”¨**ï¼šæä¾›å¾Œç«¯é¸æ“‡ï¼Œé¿å…éŽåº¦ä¾è³´
4. **çµ±ä¸€æŽ¥å£**ï¼šå°è£ä¸åŒå¾Œç«¯çš„å·®ç•°

### å¯¦ç¾ç­–ç•¥
```python
# utils/geometry/math_backend.py
class MathBackend:
    @staticmethod
    def distance(p1, p2, backend='numpy'):
        if backend == 'numpy':
            return np.linalg.norm(np.array(p2) - np.array(p1))
        elif backend == 'sympy':
            return sympy.geometry.Point(p1).distance(sympy.geometry.Point(p2))
        else:  # Pure Python fallback
            return math.sqrt((p2[0]-p1[0])**2 + (p2[1]-p1[1])**2)
```

## ðŸš¨ **é—œéµé‡æ§‹åŽŸå‰‡** (2025-09-02 é‡è¦æ±ºç­–)

**é‡è¦æ±ºç­–**: ç¶“éŽæ·±å…¥æª¢è¨Žï¼Œç¢ºå®šç•¶å‰å•é¡Œä¸åœ¨æž¶æ§‹è¨­è¨ˆï¼Œè€Œåœ¨æ–¼åŸ·è¡Œä¸å®Œæ•´å’Œå‘å¾Œç›¸å®¹æ··äº‚ã€‚

### ðŸŽ¯ **ä¸‰å€‹é—œéµåŽŸå‰‡ï¼ˆå¿…é ˆåŒæ™‚å¯¦ç¾ï¼‰**

#### 1. **å®Œæˆç•¶å‰æž¶æ§‹ï¼šè£œå®Œç¼ºå¤±çš„æ ¸å¿ƒåŠŸèƒ½**
- **ä¿æŒ6å±¤æž¶æ§‹**ï¼šcore/geometry/tikz/latex/rendering/orchestration
- **è£œå®Œæ ¸å¿ƒåŠŸèƒ½**ï¼šä¸‰è§’å½¢æ§‹é€ ã€ç‰¹æ®Šé»žè¨ˆç®—ç­‰é—œéµç¼ºå¤±åŠŸèƒ½
- **ç†ç”±**: å·²æŠ•å…¥ ~8,439è¡Œé«˜å“è³ªä»£ç¢¼ï¼Œè·è²¬åˆ†é›¢æ¸…æ™°ï¼Œä¸æ‡‰å»¢æ£„

#### 2. **å¾¹åº•ç§»é™¤èˆŠAPIï¼šåˆªé™¤æ‰€æœ‰å‘å¾Œç›¸å®¹å±¤**
- **å®Œå…¨åˆªé™¤èˆŠæ–‡ä»¶**: `geometry_utils.py`, `latex_generator.py` ç­‰
- **ç§»é™¤æ‰€æœ‰ `get_*` èˆŠå‡½æ•¸**: ä¸ä¿ç•™ä»»ä½•å‘å¾Œç›¸å®¹æŽ¥å£
- **ç†ç”±**: æ–°èˆŠAPIæ··ç”¨æ˜¯ç•¶å‰æœ€å¤§å•é¡Œï¼Œå°Žè‡´æž¶æ§‹æ··äº‚

#### 3. **è¨­è¨ˆçµ±ä¸€å…¥å£ï¼šå»ºç«‹æ¸…æ™°çš„utils/__init__.py**
- **ç¾ä»£åŒ–APIè¨­è¨ˆ**: ç›´è§€ã€ä¸€è‡´çš„å°Žå…¥æŽ¥å£
- **æ¨™æº–å·¥ä½œæµå®šç¾©**: æ˜Žç¢ºçš„ä½¿ç”¨æ¨¡å¼å’Œæœ€ä½³å¯¦è¸
- **ç†ç”±**: è®“å…¶ä»–é–‹ç™¼è€…5åˆ†é˜å…§ç†è§£æ•´å€‹æž¶æ§‹

### âš ï¸ **åŸ·è¡ŒåŽŸå‰‡**
é€™ä¸‰å€‹åŽŸå‰‡**å¿…é ˆåŒæ™‚å¯¦ç¾**ï¼Œç¼ºä¸€ä¸å¯ï¼š
- åªå®ŒæˆåŠŸèƒ½è€Œä¸ç§»é™¤èˆŠAPI â†’ ç¹¼çºŒæ–°èˆŠä¸¦å­˜å•é¡Œ
- åªç§»é™¤èˆŠAPIè€Œä¸è¨­è¨ˆçµ±ä¸€å…¥å£ â†’ ä½¿ç”¨è€…å›°æƒ‘  
- åªè¨­è¨ˆå…¥å£è€Œä¸å®ŒæˆåŠŸèƒ½ â†’ åŠŸèƒ½ä¸å®Œæ•´

## é‡æ§‹ç­–ç•¥

### æ¿€é€²ä¹¾æ·¨é‡æ§‹åŽŸå‰‡
åŸºæ–¼åˆ†æžç™¼ç¾å½±éŸ¿ç¯„åœæœ‰é™ï¼ˆä¸»è¦æ˜¯ `figures/predefined/predefined_triangle.py`ï¼‰ï¼ŒæŽ¡ç”¨ï¼š
- **å¾¹åº•ç§»é™¤å‘å¾Œç›¸å®¹å±¤**ï¼Œé¿å…ç”¢ç”Ÿæ–°çš„æŠ€è¡“å‚µå‹™
- **ä¸€æ¬¡æ€§å®Œæ•´æ›¿æ›**ï¼ŒåŒæ­¥æ›´æ–°æ‰€æœ‰èª¿ç”¨æ–¹
- **çµ±ä¸€APIè¨­è¨ˆ**ï¼Œå»ºç«‹æ¸…æ™°çš„ä½¿ç”¨æ¨¡å¼
- **å®Œæ•´æ¸¬è©¦è¦†è“‹**ï¼Œç¢ºä¿åŠŸèƒ½æ­£ç¢ºæ€§

### é—œéµé·ç§»æ˜ å°„

#### å‡½æ•¸åç¨±å°æ‡‰
| èˆŠæ¨¡çµ„/å‡½æ•¸ | æ–°æ¨¡çµ„/å‡½æ•¸ | è®Šæ›´èªªæ˜Ž |
|------------|------------|----------|
| `utils.geometry_utils.get_vertices()` | `utils.geometry.construct_triangle()` | çµ±ä¸€ä¸‰è§’å½¢æ§‹é€ æŽ¥å£ |
| `utils.geometry_utils.get_label_placement_params()` | `utils.tikz.position_vertex_label()` ç­‰ | æŒ‰å…ƒç´ é¡žåž‹åˆ†é›¢å‡½æ•¸ |
| `utils.geometry_utils.get_arc_render_params()` | `utils.tikz.calculate_arc_params()` | èªžç¾©æ›´æ¸…æ™°çš„å‘½å |
| `utils.geometry_utils._distance()` | `utils.geometry.distance()` | å…¬é–‹ APIï¼ŒåŽ»é™¤ç§æœ‰å‰ç¶´ |
| `utils.geometry_utils.TriangleDefinitionError` | `utils.geometry.TriangleConstructionError` | æ›´æº–ç¢ºçš„ç•°å¸¸å‘½å |

#### å°Žå…¥èªžå¥è®Šæ›´
```python
# èˆŠçš„å°Žå…¥ (predefined_triangle.py)
from utils.geometry_utils import (
    get_vertices, TriangleDefinitionError,
    get_midpoint, get_centroid, get_incenter, get_circumcenter, get_orthocenter,
    get_arc_render_params, get_label_placement_params, _distance
)

# æ–°çš„å°Žå…¥ (é‡æ§‹å¾Œ)
from utils.geometry import (
    construct_triangle, TriangleConstructionError,
    get_midpoint, get_centroid, get_incenter, get_circumcenter, get_orthocenter,
    distance
)
from utils.tikz import (
    calculate_arc_params, position_vertex_label, position_side_label, position_angle_label
)
```

## è©³ç´°å¯¦æ–½è¨ˆç•«

### éšŽæ®µä¸€ï¼šåŸºç¤Žè¨­æ–½å»ºç«‹ï¼ˆ3-4 å¤©ï¼‰

#### ä»»å‹™ 1.1ï¼šå‰µå»ºæ–°æž¶æ§‹ç›®éŒ„çµæ§‹
- [ ] å‰µå»ºæ‰€æœ‰æ–°æ¨¡çµ„ç›®éŒ„
- [ ] å»ºç«‹å„æ¨¡çµ„çš„ `__init__.py` æ–‡ä»¶
- [ ] è¨­ç½®åŸºç¤Žçš„å°Žå…¥çµæ§‹

#### ä»»å‹™ 1.2ï¼šçµ±ä¸€åŸºç¤Žè¨­æ–½
- [ ] **`utils/core/config.py`** - çµ±ä¸€é…ç½®ç®¡ç†
  ```python
  class GlobalConfig:
      def __init__(self):
          self.debug_mode = False
          self.log_level = "INFO"
          self.math_backend_default = "numpy"
          self.tikz_precision = 7  # decimal places
  ```

- [ ] **`utils/core/logging.py`** - çµ±ä¸€æ—¥èªŒç³»çµ±
  ```python
  import logging
  
  def setup_logger(name: str, level: str = "INFO") -> logging.Logger:
      logger = logging.getLogger(name)
      # çµ±ä¸€çš„æ—¥èªŒæ ¼å¼å’Œè™•ç†å™¨
      return logger
  ```

- [ ] **æ¸…ç†ç¾æœ‰ä»£ç¢¼å“è³ªå•é¡Œ**
  - ç§»é™¤ `registry.py` ä¸­çš„èª¿è©¦ print èªžå¥
  - ä¿®å¾© `layout_engine.py` çš„è‡¨æ™‚è¨»é‡‹
  - æ¸…ç† `pdf_generator.py` çš„æ ¼å¼å•é¡Œ

#### ä»»å‹™ 1.3ï¼šå»ºç«‹æ¸¬è©¦æ¡†æž¶
- [ ] è¨­ç½® pytest æ¸¬è©¦ç’°å¢ƒ
- [ ] å‰µå»ºæ¸¬è©¦å·¥å…·å‡½æ•¸
- [ ] å»ºç«‹åŸºæº–æ¸¬è©¦æ•¸æ“š

### éšŽæ®µäºŒï¼šæ ¸å¿ƒæ¨¡çµ„é‡æ§‹ï¼ˆ4-5 å¤©ï¼‰

#### ä»»å‹™ 2.1ï¼šå¹¾ä½•è¨ˆç®—æ¨¡çµ„
- [ ] **`utils/geometry/math_backend.py`**
  - NumPy/SymPy é›†æˆå±¤
  - é¡žåž‹è½‰æ›å·¥å…·
  - çµ±ä¸€æ•¸å­¸é‹ç®—æŽ¥å£

- [ ] **`utils/geometry/basic_ops.py`**
  ```python
  def distance(p1: Point, p2: Point, backend: str = 'numpy') -> float
  def get_midpoint(p1: Point, p2: Point) -> Point
  def angle_between_points(p1: Point, vertex: Point, p2: Point) -> float
  def normalize_angle(angle_rad: float) -> float
  ```

- [ ] **`utils/geometry/triangle_construction.py`**
  ```python
  def construct_triangle_sss(side_a: float, side_b: float, side_c: float) -> Triangle
  def construct_triangle_sas(side1: float, angle_rad: float, side2: float) -> Triangle
  def construct_triangle_asa(angle1_rad: float, side_length: float, angle2_rad: float) -> Triangle
  def construct_triangle_aas(angle1_rad: float, angle2_rad: float, side_opposite_angle1: float) -> Triangle
  
  # çµ±ä¸€æŽ¥å£
  def construct_triangle(mode: str, **kwargs) -> Triangle
  ```

- [ ] **`utils/geometry/triangle_centers.py`**
  - ä½¿ç”¨ SymPy.geometry é‡å¯«ç‰¹æ®Šé»žè¨ˆç®—
  - æä¾›é«˜ç²¾åº¦å’Œé«˜æ€§èƒ½å…©ç¨®æ¨¡å¼
  ```python
  def get_centroid(triangle: Triangle, backend: str = 'sympy') -> Point
  def get_incenter(triangle: Triangle, backend: str = 'sympy') -> Point
  def get_circumcenter(triangle: Triangle, backend: str = 'sympy') -> Point
  def get_orthocenter(triangle: Triangle, backend: str = 'sympy') -> Point
  def get_all_centers(triangle: Triangle) -> Dict[str, Point]
  ```

#### ä»»å‹™ 2.2ï¼šä½ˆå±€å¼•æ“Žé‡æ§‹
- [ ] **é‡æ§‹ `utils/core/layout_engine.py`**
  - æå–é‡è¤‡çš„æ”¾ç½®é‚è¼¯
  - æ”¹å–„å¯è®€æ€§å’Œå¯æ¸¬è©¦æ€§
  ```python
  def _try_place_item(self, item_data, page, grids, dimensions):
      """æå–çš„é€šç”¨æ”¾ç½®æ–¹æ³•"""
      
  def _create_layout_result(self, item, page, row, col, dimensions):
      """å‰µå»ºä½ˆå±€çµæžœçš„çµ±ä¸€æ–¹æ³•"""
  ```

#### ä»»å‹™ 2.3ï¼šè¨»å†Šç³»çµ±æ”¹é€²
- [ ] **æ”¹é€² `utils/core/registry.py`**
  - ç·šç¨‹å®‰å…¨çš„å–®ä¾‹å¯¦ç¾
  - ä½¿ç”¨æ—¥èªŒæ›¿ä»£ print èªžå¥
  - æ·»åŠ è¨»å†Šé©—è­‰æ©Ÿåˆ¶

### éšŽæ®µä¸‰ï¼šTikZ èˆ‡ LaTeX æ¨¡çµ„é‡æ§‹ï¼ˆ5-6 å¤©ï¼‰

#### ä»»å‹™ 3.1ï¼šTikZ è¼”åŠ©æ¨¡çµ„
- [ ] **`utils/tikz/coordinate_transform.py`**
  ```python
  def tikz_coordinate(point: Point, precision: int = 7) -> str
  def tikz_angle_degrees(radians: float) -> float
  def tikz_distance(value: float, unit: str = "cm") -> str
  ```

- [ ] **`utils/tikz/arc_parameters.py`**
  - é‡æ§‹ `get_arc_render_params()` ç‚º `calculate_arc_params()`
  - ç°¡åŒ–è§’åº¦è¨ˆç®—é‚è¼¯
  - ä½¿ç”¨ NumPy å‘é‡é‹ç®—

- [ ] **`utils/tikz/label_positioning.py`**
  - åˆ†è§£å·¨å¤§çš„ `get_label_placement_params()` å‡½æ•¸
  ```python
  class LabelPositioner:
      def position_vertex_label(self, vertex, adjacent_vertices, config)
      def position_side_label(self, p_start, p_end, triangle_vertices, config)
      def position_angle_label(self, vertex, arm1, arm2, config)
  ```

#### ä»»å‹™ 3.2ï¼šLaTeX æ¨¡çµ„æ”¹é€²
- [ ] **`utils/latex/compiler.py`**
  - æ·»åŠ ç·¨è­¯å¿«å–æ©Ÿåˆ¶
  - æ”¹é€²éŒ¯èª¤è™•ç†å’Œæ—¥èªŒè¨˜éŒ„
  - æ¸…ç†è‡¨æ™‚æ–‡ä»¶ç®¡ç†

- [ ] **`utils/latex/generator.py`**
  - é‡æ§‹éŽé•·çš„ç”Ÿæˆæ–¹æ³•
  - åˆ†é›¢åœ–å½¢è™•ç†é‚è¼¯
  - æ”¹å–„é…ç½®ç®¡ç†

- [ ] **`utils/latex/structure.py`**
  - æ¸›å°‘ç¡¬ç·¨ç¢¼çš„ LaTeX æ¨£å¼
  - æä¾›å¯é…ç½®çš„æ¨£å¼é¸é …
  - æ¨¡æ¿åŒ–å¸¸ç”¨çµæ§‹

#### ä»»å‹™ 3.3ï¼šåœ–å½¢æ¸²æŸ“æ”¹é€²
- [ ] **`utils/rendering/figure_renderer.py`**
  - è§£è€¦èˆ‡ `figures` æ¨¡çµ„çš„ç›´æŽ¥ä¾è³´
  - æ”¹é€²éŒ¯èª¤è™•ç†
  - æ·»åŠ æ¸²æŸ“å¿«å–

### éšŽæ®µå››ï¼šæ¥­å‹™å”èª¿å±¤é‡æ§‹ï¼ˆ3-4 å¤©ï¼‰

#### ä»»å‹™ 4.1ï¼šPDF ç”Ÿæˆå™¨é‡æ§‹
- [ ] **`utils/orchestration/pdf_generator.py`**
  - ç°¡åŒ– `_distribute_questions()` è¤‡é›œé‚è¼¯
  - åˆ†é›¢é¡Œç›®ç”Ÿæˆå’Œåˆ†é…é‚è¼¯
  - æ”¹é€²éŒ¯èª¤è™•ç†å’Œé€²åº¦å›žå ±
  
  ```python
  class PDFOrchestrator:
      def __init__(self, config: GlobalConfig):
          self.config = config
          self.layout_engine = LayoutEngine()
          self.latex_generator = LaTeXGenerator()
          
      def generate_pdfs(self, output_config, content_config) -> PDFResult
  ```

#### ä»»å‹™ 4.2ï¼šçµ±ä¸€ API è¨­è¨ˆ
- [ ] **`utils/__init__.py`**
  - è¨­è¨ˆæ¸…æ™°çš„æ¨¡çµ„å°Žå…¥æŽ¥å£
  - å»ºç«‹ä¸€è‡´çš„ API é¢¨æ ¼æŒ‡å—
  - æ–‡æª”åŒ–æœ€ä½³ä½¿ç”¨æ–¹å¼
  ```python
  # æŽ¨è–¦çš„å°Žå…¥æ–¹å¼
  from utils.geometry import distance, construct_triangle, get_centroid
  from utils.tikz import position_vertex_label, calculate_arc_params
  from utils.orchestration import generate_pdf
  ```

### éšŽæ®µäº”ï¼šæ¸¬è©¦èˆ‡é›†æˆï¼ˆ3-4 å¤©ï¼‰

#### ä»»å‹™ 5.1ï¼šå…¨é¢æ¸¬è©¦
- [ ] **å–®å…ƒæ¸¬è©¦**
  - æ‰€æœ‰æ–°æ¨¡çµ„çš„å–®å…ƒæ¸¬è©¦
  - æ¸¬è©¦è¦†è“‹çŽ‡ > 90%
  - é‚Šç•Œæƒ…æ³å’ŒéŒ¯èª¤è™•ç†æ¸¬è©¦

- [ ] **é›†æˆæ¸¬è©¦**
  - èˆ‡ `figures/predefined/predefined_triangle.py` çš„é›†æˆæ¸¬è©¦
  - å®Œæ•´çš„ PDF ç”Ÿæˆæµç¨‹æ¸¬è©¦
  - æ€§èƒ½åŸºæº–æ¸¬è©¦

- [ ] **ç›¸å®¹æ€§æ¸¬è©¦**
  - ç¢ºä¿æ‰€æœ‰ç¾æœ‰åŠŸèƒ½æ­£å¸¸
  - å°æ¯”é‡æ§‹å‰å¾Œçš„è¼¸å‡º
  - å›žæ­¸æ¸¬è©¦

#### ä»»å‹™ 5.2ï¼šé·ç§»èˆ‡æ¸…ç†
- [ ] **ä»£ç¢¼é·ç§»**
  - æ›´æ–° `figures/predefined/predefined_triangle.py`
  - æª¢æŸ¥å…¶ä»–æ½›åœ¨èª¿ç”¨æ–¹
  - å…¨å±€æœç´¢ç¢ºèªå®Œæ•´é·ç§»

- [ ] **æœ€çµ‚æ¸…ç†**
  - åˆªé™¤èˆŠçš„ `geometry_utils.py`
  - æ¸…ç†æœªä½¿ç”¨çš„å°Žå…¥å’Œä¾è³´
  - æ›´æ–°æ–‡æª”å’Œç¤ºä¾‹

### éšŽæ®µå…­ï¼šæ–‡æª”èˆ‡å„ªåŒ–ï¼ˆ2-3 å¤©ï¼‰

#### ä»»å‹™ 6.1ï¼šæ–‡æª”å®Œå–„
- [ ] API æ–‡æª”ç”Ÿæˆ
- [ ] ä½¿ç”¨æŒ‡å—å’Œé·ç§»æŒ‡å—
- [ ] æž¶æ§‹è¨­è¨ˆæ–‡æª”
- [ ] æ€§èƒ½å°æ¯”å ±å‘Š

#### ä»»å‹™ 6.2ï¼šæ€§èƒ½å„ªåŒ–
- [ ] åŸºæ–¼æ¸¬è©¦çµæžœçš„æ€§èƒ½èª¿å„ª
- [ ] è¨˜æ†¶é«”ä½¿ç”¨å„ªåŒ–
- [ ] ç·¨è­¯å¿«å–å¯¦ç¾
- [ ] ä¸¦ç™¼è™•ç†æ”¹é€²ï¼ˆå¦‚é©ç”¨ï¼‰

## ä¾è³´ç®¡ç†

### æ–°å¢žä¾è³´
```python
# requirements.txt æ–°å¢ž
numpy>=1.21.0        # æ•¸å€¼è¨ˆç®—
sympy>=1.9.0         # ç¬¦è™Ÿæ•¸å­¸è¨ˆç®—

# é–‹ç™¼ä¾è³´
pytest>=6.0.0        # æ¸¬è©¦æ¡†æž¶
pytest-cov>=2.12.0   # æ¸¬è©¦è¦†è“‹çŽ‡
pytest-benchmark>=3.4.1  # æ€§èƒ½åŸºæº–æ¸¬è©¦
```

### ä¾è³´ç­–ç•¥
- **æ ¸å¿ƒåŠŸèƒ½ä¸ä¾è³´é‡é‡ç´šåº«**ï¼šåŸºç¤Žå¹¾ä½•è¨ˆç®—æä¾›ç´” Python å‚™ç”¨
- **å¯é¸ä¾è³´**ï¼šNumPy/SymPy ä½œç‚ºå¯é¸çš„æ€§èƒ½å¢žå¼·
- **ç‰ˆæœ¬éŽ–å®š**ï¼šç¢ºä¿ä¾è³´ç‰ˆæœ¬ç©©å®šæ€§

## é¢¨éšªè©•ä¼°èˆ‡æ‡‰å°

### ä¸»è¦é¢¨éšª
1. **é‡æ§‹ç¯„åœå¤§**ï¼šæ¶‰åŠå¤šå€‹æ ¸å¿ƒæ¨¡çµ„
   - **æ‡‰å°**ï¼šåˆ†éšŽæ®µå¯¦æ–½ï¼Œæ¯éšŽæ®µéƒ½æœ‰å®Œæ•´æ¸¬è©¦
   
2. **æ€§èƒ½å½±éŸ¿**ï¼šæ–°çš„æŠ½è±¡å±¤å¯èƒ½å½±éŸ¿æ€§èƒ½
   - **æ‡‰å°**ï¼šå»ºç«‹æ€§èƒ½åŸºæº–ï¼Œæä¾›æ€§èƒ½ç›£æŽ§

3. **ä¾è³´é¢¨éšª**ï¼šæ–°å¢ž NumPy/SymPy ä¾è³´
   - **æ‡‰å°**ï¼šæä¾›ç´” Python å‚™ç”¨å¯¦ç¾ï¼Œä¾è³´å¯é¸

4. **é›†æˆè¤‡é›œ**ï¼šå¤šå€‹æ¨¡çµ„åŒæ™‚è®Šæ›´
   - **æ‡‰å°**ï¼šå¼·åŒ–é›†æˆæ¸¬è©¦ï¼Œå»ºç«‹è‡ªå‹•åŒ–é©—è­‰

### å›žæ»¾ç­–ç•¥
1. **ç‰ˆæœ¬æŽ§åˆ¶**ï¼šæ¯å€‹éšŽæ®µéƒ½æœ‰æ˜Žç¢ºçš„ git æ¨™ç±¤
2. **å‚™ä»½æ©Ÿåˆ¶**ï¼šä¿ç•™æ‰€æœ‰åŽŸå§‹æ–‡ä»¶çš„å‚™ä»½
3. **æ¼¸é€²éƒ¨ç½²**ï¼šå¯ä»¥éšŽæ®µæ€§å›žæ»¾åˆ°ä»»æ„éšŽæ®µ
4. **åŠŸèƒ½é–‹é—œ**ï¼šé—œéµåŠŸèƒ½æä¾›æ–°èˆŠå¯¦ç¾åˆ‡æ›

## æˆåŠŸæ¨™æº–

### ä»£ç¢¼å“è³ªæŒ‡æ¨™
- [ ] å–®å…ƒæ¸¬è©¦è¦†è“‹çŽ‡ > 90%
- [ ] é›†æˆæ¸¬è©¦è¦†è“‹çŽ‡ > 80%
- [ ] å–®å€‹æ¨¡çµ„æ–‡ä»¶è¡Œæ•¸ < 300 è¡Œ
- [ ] ç„¡èª¿è©¦è¼¸å‡ºæ´©æ¼åˆ°ç”Ÿç”¢ç’°å¢ƒ
- [ ] ç„¡å¾ªç’°ä¾è³´ï¼Œä¾è³´é—œä¿‚æ¸…æ™°
- [ ] ä»£ç¢¼é‡è¤‡çŽ‡ < 5%

### åŠŸèƒ½æ€§æŒ‡æ¨™
- [ ] æ‰€æœ‰ç¾æœ‰åŠŸèƒ½æ­£å¸¸é‹ä½œ
- [ ] PDF ç”Ÿæˆçµæžœèˆ‡é‡æ§‹å‰ä¸€è‡´
- [ ] æ‰€æœ‰åœ–å½¢é¡žåž‹æ­£ç¢ºæ¸²æŸ“
- [ ] éŒ¯èª¤è™•ç†æ©Ÿåˆ¶å®Œå–„

### æ€§èƒ½æŒ‡æ¨™
- [ ] åŸºç¤Žé‹ç®—æ€§èƒ½ä¸ä½Žæ–¼åŽŸå¯¦ç¾
- [ ] è¤‡é›œè¨ˆç®—ï¼ˆä¸‰è§’å½¢ç‰¹æ®Šé»žï¼‰æ€§èƒ½æå‡ > 20%
- [ ] PDF ç”Ÿæˆæ™‚é–“ä¸å¢žåŠ  > 10%
- [ ] è¨˜æ†¶é«”ä½¿ç”¨å¢žåŠ  < 50%

### å¯ç¶­è­·æ€§æŒ‡æ¨™
- [ ] æ–°å¢žåŠŸèƒ½åªéœ€ä¿®æ”¹å°æ‡‰æ¨¡çµ„
- [ ] æ¸…æ™°çš„éŒ¯èª¤ä¿¡æ¯å’Œæ—¥èªŒ
- [ ] API è¨­è¨ˆç›´è§€æ˜“ç”¨
- [ ] æ–‡æª”å®Œæ•´ï¼Œç¤ºä¾‹æ¸…æ™°

## æ™‚é–“å®‰æŽ’èˆ‡è³‡æºåˆ†é…

| éšŽæ®µ | ä¸»è¦ä»»å‹™ | é ä¼°æ™‚é–“ | é—œéµé¢¨éšª | è¼¸å‡ºç‰© |
|------|----------|----------|----------|--------|
| 1 | åŸºç¤Žè¨­æ–½å»ºç«‹ | 3-4 å¤© | æž¶æ§‹è¨­è¨ˆé¢¨éšª | æ–°ç›®éŒ„çµæ§‹ã€åŸºç¤Žè¨­æ–½ä»£ç¢¼ |
| 2 | æ ¸å¿ƒæ¨¡çµ„é‡æ§‹ | 4-5 å¤© | æ•¸å­¸è¨ˆç®—ç²¾åº¦é¢¨éšª | å¹¾ä½•è¨ˆç®—æ¨¡çµ„ã€ä½ˆå±€å¼•æ“Ž |
| 3 | TikZ/LaTeX é‡æ§‹ | 5-6 å¤© | LaTeX ç›¸å®¹æ€§é¢¨éšª | æ¸²æŸ“ç›¸é—œæ¨¡çµ„ |
| 4 | æ¥­å‹™å”èª¿å±¤ | 3-4 å¤© | åŠŸèƒ½é›†æˆé¢¨éšª | PDF ç”Ÿæˆå”èª¿å™¨ |
| 5 | æ¸¬è©¦èˆ‡é›†æˆ | 3-4 å¤© | æ¸¬è©¦è¦†è“‹çŽ‡é¢¨éšª | æ¸¬è©¦å¥—ä»¶ã€é·ç§»å®Œæˆ |
| 6 | æ–‡æª”èˆ‡å„ªåŒ– | 2-3 å¤© | æ–‡æª”å®Œæ•´æ€§é¢¨éšª | æ–‡æª”ã€æ€§èƒ½å ±å‘Š |

**ç¸½è¨ˆï¼š20-26 å¤©**

## å¾ŒçºŒæ”¹é€²è¦åŠƒ

é‡æ§‹å®Œæˆå¾Œçš„æŒçºŒæ”¹é€²æ–¹å‘ï¼š

### çŸ­æœŸæ”¹é€²ï¼ˆ1-3 å€‹æœˆï¼‰
1. **æ€§èƒ½ç›£æŽ§ç³»çµ±**ï¼šå»ºç«‹æ€§èƒ½æŒ‡æ¨™æ”¶é›†å’Œç›£æŽ§
2. **æ›´å¤šæ•¸å­¸åŠŸèƒ½**ï¼šæ“´å±•å¹¾ä½•å½¢ç‹€æ”¯æŒï¼ˆæ©¢åœ“ã€å¤šé‚Šå½¢ï¼‰
3. **æ¨¡æ¿ç³»çµ±**ï¼šå¯é…ç½®çš„ LaTeX æ¨£å¼æ¨¡æ¿
4. **å¿«å–æ©Ÿåˆ¶**ï¼šæ™ºèƒ½çš„è¨ˆç®—å’Œç·¨è­¯å¿«å–

### ä¸­æœŸæ”¹é€²ï¼ˆ3-6 å€‹æœˆï¼‰
1. **3D å¹¾ä½•æ”¯æŒ**ï¼šæ“´å±•åˆ°ç«‹é«”å¹¾ä½•è¨ˆç®—
2. **ä¸¦è¡Œè™•ç†**ï¼šå¤§æ‰¹é‡é¡Œç›®ç”Ÿæˆçš„ä¸¦è¡ŒåŒ–
3. **å¯è¦–åŒ–å·¥å…·**ï¼šå¹¾ä½•è¨ˆç®—çµæžœçš„å³æ™‚é è¦½
4. **API æ“´å±•**ï¼šæä¾› REST API ç”¨æ–¼é ç¨‹èª¿ç”¨

### é•·æœŸè¦åŠƒï¼ˆ6-12 å€‹æœˆï¼‰
1. **å¤šæ ¼å¼æ”¯æŒ**ï¼šSVGã€Canvasã€WebGL æ¸²æŸ“å™¨
2. **AI é›†æˆ**ï¼šæ™ºèƒ½çš„ä½ˆå±€å„ªåŒ–å’Œæ¨£å¼å»ºè­°
3. **é›²ç«¯éƒ¨ç½²**ï¼šå®¹å™¨åŒ–å’Œé›²ç«¯æœå‹™æ”¯æŒ
4. **æ’ä»¶ç³»çµ±**ï¼šç¬¬ä¸‰æ–¹æ“´å±•æ©Ÿåˆ¶

---

**æ–‡ä»¶ç‰ˆæœ¬**ï¼š2.0  
**å‰µå»ºæ—¥æœŸ**ï¼š2025-09-01  
**æœ€å¾Œæ›´æ–°**ï¼š2025-09-01  
**ç‹€æ…‹**ï¼šå¾…åŸ·è¡Œ  
**é ä¼°å®Œæˆ**ï¼š2025-09-27