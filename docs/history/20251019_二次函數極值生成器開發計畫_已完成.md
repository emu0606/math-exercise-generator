# **二次函數極值生成器 - 開發工作計畫**

> **生成日期**: 2025-10-19
> **題型**: 二次函數的極值
> **目標**: 開發一個能夠生成兩種二次函數極值問題的生成器。
> **開發模式**: 計畫模式

---

## 1. 需求摘要

### 1.1 題目描述
-   **題目要求**:
    1.  **全域極值**: 找出二次函數 `y=ax^2+bx+c` 的頂點極值。
    2.  **區間極值**: 找出二次函數在給定 x 範圍內的最大與最小值。
-   **給定資訊**:
    -   題型1: `y=ax^2+bx+c`
    -   題型2: `y=ax^2+bx+c` 及 x 的範圍 (例如 `x1 < x < x2`)
-   **答案格式**:
    -   題型1: `當 x=h 時，y有最[大/小]值 k`
    -   題型2: `最大值為 M，最小值為 m`
-   **詳解層級**: 標準 (顯示配方法、端點距離比較、答案)。

### 1.2 元數據
-   **主分類**: 數與式 (對應 `algebra` 子目錄)
-   **子分類**: 二次函數的極值
-   **年級**: G10S1 (高一上)
-   **題目尺寸**: SQUARE (1x2)

### 1.3 技術選型
-   **選用典範**: B - 數值計算可調
-   **數學策略**: **由答案逆推生成**。先隨機選取整數 `a, h, k`，再展開 `y=a(x-h)^2+k` 得到 `b` 和 `c`。
-   **配置需求**: 需要，包含題型比例和係數範圍。

---

## 2. 實作計畫

### 2.1 準備階段
-   **任務**: 檢查 `generators/algebra/__init__.py` 是否符合專案的自動註冊規範。
-   **動作**: 如不符合，將其修正為標準的 `__all__ = []` 模式，以確保新生成器能被系統自動載入。

### 2.2 生成器類別實作
-   **任務**: 撰寫生成器主體代碼。
-   **檔案路徑**: `generators/algebra/quadratic_extremum_generator.py`
-   **類別名稱**: `QuadraticExtremumGenerator`
-   **結構**:
    ```python
    @register_generator
    class QuadraticExtremumGenerator(QuestionGenerator):
        """
        (完整 Sphinx 文檔)
        """
        def __init__(self, options=None):
            # ...
        
        @classmethod
        def get_config_schema(cls):
            # ...

        def _generate_core_question(self):
            # ...

        # ... (元數據方法)
    ```

### 2.3 配置系統實作
-   **任務**: 實作 `get_config_schema()` 方法以定義使用者介面中的配置項。
-   **配置項 1: `question_types` (題型比例)**
    -   **類型**: `percentage_group`
    -   **項目**: `global_extremum` (全域極值), `interval_extremum` (區間極值)
    -   **預設值**: `global_extremum: 50`, `interval_extremum: 50`
-   **配置項 2: `coefficients_range` (係數範圍)**
    -   **類型**: 複合 `number_input`
    -   **項目**: `a_range`, `h_range`, `k_range`
    -   **預設值**: `a` 在 `[-10, 10]` (不含0)，`h` 和 `k` 在 `[-10, 10]`。

### 2.4 數學邏輯實作
-   **任務**: 在 `_generate_core_question()` 中實作核心數學邏輯。
-   **步驟**:
    1.  根據 `question_types` 配置的權重，隨機決定本次要生成的題型（全域或區間）。
    2.  根據 `coefficients_range` 配置，隨機選取 `a, h, k` 的值。
    3.  **逆推計算**:
        -   `b = -2 * a * h`
        -   `c = a * h^2 + k`
    4.  **如果生成「區間極值」題型**:
        -   根據 70/30 的硬編碼比例，決定區間是否包含頂點 `h`。
        -   生成一個合理的 x 範圍 `[x1, x2]`。
    5.  根據題型和計算結果，組合出題目、答案和詳解字串。

### 2.5 文檔撰寫
-   **任務**: 為模組、類別和主要方法撰寫符合 Sphinx 格式的完整 Docstrings。

---

## 3. 測試驗證計畫

### 3.1 基礎測試
我將執行以下指令來快速驗證生成器的基本功能：
-   **導入測試**: `py -c "from generators.algebra.quadratic_extremum_generator import QuadraticExtremumGenerator; print('✅ 導入成功')"`
-   **實例化測試**: `py -c "from generators.algebra.quadratic_extremum_generator import QuadraticExtremumGenerator; gen = QuadraticExtremumGenerator(); print('✅ 實例化成功')"`
-   **生成測試**: `py -c "from generators.algebra.quadratic_extremum_generator import QuadraticExtremumGenerator; gen = QuadraticExtremumGenerator(); q = gen.generate_question(); print('✅ 生成成功:', q['question'])"`

### 3.2 檢查清單驗證
-   在開發過程中，我將對照開發指南中的檢查清單 (C001-C205, T001-T005, I001-I003) 進行自我驗證。

---

## 4. 時間估算

| 階段 | 預估時間 |
| :--- | :--- |
| 準備與實作 | 10-15 分鐘 |
| 配置與數學邏輯 | 5-10 分鐘 |
| 文檔與測試 | 5 分鐘 |
| **總計** | **20-30 分鐘** |

---

## 5. 風險評估

| 風險項 | 影響程度 | 緩解措施 |
| :--- | :--- | :--- |
| `a` 值為 0 | 中 | 在隨機選取 `a` 時，明確排除 0。 |
| 區間生成邏輯複雜 | 低 | 嚴格遵循「包含/不包含頂點」的邏輯，並在樣本中已驗證。 |
| LaTeX 格式錯誤 | 低 | 遵循專案的 LaTeX 格式規範，優先使用空格分隔。 |
