# 生成器基類相容性修復計畫

> **日期**: 2025-09-28
> **狀態**: 已完成
> **目標**: 修復四個典範生成器與基類的相容性問題

## 🎯 問題識別

### **1. 雙重根號生成器重複方法定義**
- **檔案**: `generators/algebra/double_radical_simplification.py`
- **問題**: `get_question_size()` 方法重複定義 (Line 464-467 和 493-496)
- **影響**: 代碼重複，可能造成維護問題

### **2. 類型一致性確認**
- **現狀**: 所有生成器都正確返回整數類型
- **確認**: 基類期望 `int`，實作也返回 `int` - 實際上是正確的
- **結論**: 無需修改，類型一致性良好

### **3. 典範生成器完整性**
- **需求**: 作為典範，應展示基類所有方法的標準實作
- **目標**: 提供完整的開發參考範本

## 🔧 修復計畫

### **Phase 1: 修復重複定義 (5分鐘)**
```python
# 移除 double_radical_simplification.py 中的重複方法
# 保留較完整的定義，移除重複部分
```

### **Phase 2: 典範生成器完整化 (15分鐘)**
為所有典範生成器添加完整的基類方法實作：

```python
def get_subject(self) -> str:
    """獲取科目，數學測驗生成器標準實作"""
    return "數學"

def get_difficulty(self) -> str:
    """獲取難度等級，根據題目複雜度調整"""
    return "MEDIUM"  # 或根據具體生成器調整

def get_figure_data_question(self) -> Optional[Dict[str, Any]]:
    """獲取題目圖形數據"""
    return None  # 明確表達無圖形需求

def get_figure_data_explanation(self) -> Optional[Dict[str, Any]]:
    """獲取解釋圖形數據"""
    return None

def get_figure_position(self) -> str:
    """獲取題目圖形位置"""
    return "right"

def get_explanation_figure_position(self) -> str:
    """獲取解釋圖形位置"""
    return "right"
```

### **Phase 3: 驗證測試 (5分鐘)**
```bash
# 基礎導入測試
py -c "from generators.algebra.double_radical_simplification import DoubleRadicalSimplificationGenerator; print('✅ 雙重根號生成器正常')"

# 其他生成器測試
py -c "from generators.trigonometry import *; print('✅ 三角函數生成器正常')"

# 完整生成測試
python main.py
```

## 📋 實作清單

- [ ] **修復雙重根號生成器重複定義**
  - [ ] 移除重複的 `get_question_size()` 方法
  - [ ] 確保只保留一個完整定義

- [ ] **四個典範生成器完整化**
  - [ ] `DoubleRadicalSimplificationGenerator` - 添加完整基類方法
  - [ ] `TrigAngleConversionGenerator` - 添加完整基類方法
  - [ ] `InverseTrigonometricFunctionGenerator` - 添加完整基類方法
  - [ ] `TrigonometricFunctionGenerator` - 檢查並補全基類方法

- [ ] **文檔完善**
  - [ ] 為新增方法添加標準Sphinx文檔
  - [ ] 統一註解格式和風格

- [ ] **驗證測試**
  - [ ] 基礎導入測試
  - [ ] 生成器功能測試
  - [ ] UI系統集成測試

## ⏱️ 預估時間
- **總計**: 25分鐘
- **Phase 1**: 5分鐘 (緊急修復)
- **Phase 2**: 15分鐘 (典範完善)
- **Phase 3**: 5分鐘 (驗證確認)

## 🎯 完成標準
1. ✅ 無重複方法定義
2. ✅ 所有典範生成器包含完整基類方法實作
3. ✅ 類型一致性確認無誤
4. ✅ 所有生成器正常運作
5. ✅ UI系統可正常載入和使用

## 💡 備註
- 類型一致性實際上沒有問題，所有生成器都正確返回整數
- 重點是修復重複定義和提升典範生成器的完整性
- 這次修改將讓典範生成器真正成為完整的開發參考範本